var PANOLENS={REVISION:"9"},enableInlineVideo=function(){"use strict";function t(t,e,i){function n(n){i&&!i(t,e)||n.stopImmediatePropagation()}return t.addEventListener(e,n),n}function e(t,e,i,n){function o(t){i[e]=t}n&&o(t[e]),Object.defineProperty(t,e,{get:function(){return i[e]},set:o})}function i(t,e,i){i.addEventListener(e,function(){return t.dispatchEvent(new Event(e))})}function n(t,e){Promise.resolve().then(function(){t.dispatchEvent(new Event(e))})}function o(t,e,i){(l||0)+200<Date.now()&&(t[p]=!0,l=Date.now()),i||(t.currentTime=e),m[++v%3]=100*e|0}function r(t){return t.driver.currentTime>=t.video.duration}function a(){var t=this,e=t[d];t.webkitDisplayingFullscreen?t[f]():("data:"!==e.driver.src&&e.driver.src!==t.src&&(o(t,0,!0),e.driver.src=t.src),t.paused&&(e.paused=!1,0===t.buffered.length&&t.load(),e.driver.play(),e.updater.start(),e.hasAudio||(n(t,"play"),e.video.readyState>=e.video.HAVE_ENOUGH_DATA&&n(t,"playing"))))}function s(t){var e=this,i=e[d];i.driver.pause(),i.updater.stop(),e.webkitDisplayingFullscreen&&e[E](),i.paused&&!t||(i.paused=!0,i.hasAudio||n(e,"pause"),e.ended&&!e.webkitDisplayingFullscreen&&(e[p]=!0,n(e,"ended")))}function h(t,e){var a,s,h={};t[d]=h,h.paused=!0,h.hasAudio=e,h.video=t,h.updater=function(t,e,i,n){function o(i){r=e(o,n),t(i-(a||i)),a=i}var r,a;return{start:function(){r||o(0)},stop:function(){i(r),r=null,a=0}}}(function(t){var e=this;e.video.readyState>=e.video.HAVE_FUTURE_DATA?(e.hasAudio||(e.driver.currentTime=e.video.currentTime+t*e.video.playbackRate/1e3,e.video.loop&&r(e)&&(e.driver.currentTime=0)),o(e.video,e.driver.currentTime)):e.video.networkState===e.video.NETWORK_IDLE&&0===e.video.buffered.length&&e.video.load(),e.video.ended&&(delete e.video[p],e.video.pause(!0))}.bind(h),requestAnimationFrame,cancelAnimationFrame),e?h.driver=(a=t,s=new Audio,i(a,"play",s),i(a,"playing",s),i(a,"pause",s),s.crossOrigin=a.crossOrigin,s.src=a.src||a.currentSrc||"data:",s):(t.addEventListener("canplay",function(){t.paused||n(t,"playing")}),h.driver={src:t.src||t.currentSrc||"data:",muted:!0,paused:!0,pause:function(){h.driver.paused=!0},play:function(){h.driver.paused=!1,r(h)&&o(t,0)},get ended(){return r(h)}}),t.addEventListener("emptied",function(){var i=!h.driver.src||"data:"===h.driver.src;h.driver.src&&h.driver.src!==t.src&&(o(t,0,!0),h.driver.src=t.src,i||!e&&t.autoplay?h.driver.play():h.updater.stop())},!1),t.addEventListener("webkitbeginfullscreen",function(){t.paused?e&&0===h.driver.buffered.length&&h.driver.load():(t.pause(),t[f]())}),e&&(t.addEventListener("webkitendfullscreen",function(){h.driver.currentTime=t.currentTime}),t.addEventListener("seeking",function(){m.indexOf(100*t.currentTime|0)<0&&(h.driver.currentTime=t.currentTime)}))}function c(t){var e=t[p];return delete t[p],!t.webkitDisplayingFullscreen&&!e}var l,u="object"==typeof document&&"object-fit"in document.head.style&&!matchMedia("(-webkit-video-playable-inline)").matches,d="bfred-it:iphone-inline-video",p="bfred-it:iphone-inline-video:event",f="bfred-it:iphone-inline-video:nativeplay",E="bfred-it:iphone-inline-video:nativepause",m=[],v=0;return function(i,n){if(void 0===n&&(n={}),!i[d]){if(!n.everywhere){if(!u)return;if(!(n.iPad||n.ipad?/iPhone|iPod|iPad/:/iPhone|iPod/).test(navigator.userAgent))return}i.pause();var o=i.autoplay;i.autoplay=!1,h(i,!i.muted),l=(r=i)[d],r[f]=r.play,r[E]=r.pause,r.play=a,r.pause=s,e(r,"paused",l.driver),e(r,"muted",l.driver,!0),e(r,"playbackRate",l.driver,!0),e(r,"ended",l.driver),e(r,"loop",l.driver,!0),t(r,"seeking",function(t){return!t.webkitDisplayingFullscreen}),t(r,"seeked",function(t){return!t.webkitDisplayingFullscreen}),t(r,"timeupdate",c),t(r,"ended",c),i.classList.add("IIV"),i.muted&&o&&(i.play(),i.addEventListener("playing",function t(){i.autoplay=!0,i.removeEventListener("playing",t)})),/iPhone|iPod|iPad/.test(navigator.platform)||console.warn("iphone-inline-video is not guaranteed to work in emulated environments")}var r,l}}(),TWEEN=TWEEN||function(){var t=[];return{getAll:function(){return t},removeAll:function(){t=[]},add:function(e){t.push(e)},remove:function(e){var i=t.indexOf(e);-1!==i&&t.splice(i,1)},update:function(e,i){if(0===t.length)return!1;var n=0;for(e=void 0!==e?e:TWEEN.now();n<t.length;)t[n].update(e)||i?n++:t.splice(n,1);return!0}}}();"undefined"==typeof window&&"undefined"!=typeof process?TWEEN.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?TWEEN.now=window.performance.now.bind(window.performance):void 0!==Date.now?TWEEN.now=Date.now:TWEEN.now=function(){return(new Date).getTime()},TWEEN.Tween=function(t){var e,i=t,n={},o={},r={},a=1e3,s=0,h=!1,c=!1,l=!1,u=0,d=null,p=TWEEN.Easing.Linear.None,f=TWEEN.Interpolation.Linear,E=[],m=null,v=!1,g=null,y=null,N=null;this.to=function(t,e){return o=t,void 0!==e&&(a=e),this},this.start=function(t){TWEEN.add(this),c=!0,v=!1,d=void 0!==t?t:TWEEN.now(),d+=u;for(var e in o){if(o[e]instanceof Array){if(0===o[e].length)continue;o[e]=[i[e]].concat(o[e])}void 0!==i[e]&&(n[e]=i[e],n[e]instanceof Array==!1&&(n[e]*=1),r[e]=n[e]||0)}return this},this.stop=function(){return c?(TWEEN.remove(this),c=!1,null!==N&&N.call(i,i),this.stopChainedTweens(),this):this},this.end=function(){return this.update(d+a),this},this.stopChainedTweens=function(){for(var t=0,e=E.length;t<e;t++)E[t].stop()},this.delay=function(t){return u=t,this},this.repeat=function(t){return s=t,this},this.repeatDelay=function(t){return e=t,this},this.yoyo=function(t){return h=t,this},this.easing=function(t){return p=t,this},this.interpolation=function(t){return f=t,this},this.chain=function(){return E=arguments,this},this.onStart=function(t){return m=t,this},this.onUpdate=function(t){return g=t,this},this.onComplete=function(t){return y=t,this},this.onStop=function(t){return N=t,this},this.update=function(t){var c,N,w;if(t<d)return!0;!1===v&&(null!==m&&m.call(i,i),v=!0),w=p(N=(N=(t-d)/a)>1?1:N);for(c in o)if(void 0!==n[c]){var b=n[c]||0,L=o[c];L instanceof Array?i[c]=f(L,w):("string"==typeof L&&(L="+"===L.charAt(0)||"-"===L.charAt(0)?b+parseFloat(L):parseFloat(L)),"number"==typeof L&&(i[c]=b+(L-b)*w))}if(null!==g&&g.call(i,w),1===N){if(s>0){isFinite(s)&&s--;for(c in r){if("string"==typeof o[c]&&(r[c]=r[c]+parseFloat(o[c])),h){var S=r[c];r[c]=o[c],o[c]=S}n[c]=r[c]}return h&&(l=!l),d=void 0!==e?t+e:t+u,!0}null!==y&&y.call(i,i);for(var O=0,A=E.length;O<A;O++)E[O].start(d+a);return!1}return!0}},TWEEN.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){return t*t*(2.70158*t-1.70158)},Out:function(t){return--t*t*(2.70158*t+1.70158)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-TWEEN.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*TWEEN.Easing.Bounce.In(2*t):.5*TWEEN.Easing.Bounce.Out(2*t-1)+.5}}},TWEEN.Interpolation={Linear:function(t,e){var i=t.length-1,n=i*e,o=Math.floor(n),r=TWEEN.Interpolation.Utils.Linear;return e<0?r(t[0],t[1],n):e>1?r(t[i],t[i-1],i-n):r(t[o],t[o+1>i?i:o+1],n-o)},Bezier:function(t,e){for(var i=0,n=t.length-1,o=Math.pow,r=TWEEN.Interpolation.Utils.Bernstein,a=0;a<=n;a++)i+=o(1-e,n-a)*o(e,a)*t[a]*r(n,a);return i},CatmullRom:function(t,e){var i=t.length-1,n=i*e,o=Math.floor(n),r=TWEEN.Interpolation.Utils.CatmullRom;return t[0]===t[i]?(e<0&&(o=Math.floor(n=i*(1+e))),r(t[(o-1+i)%i],t[o],t[(o+1)%i],t[(o+2)%i],n-o)):e<0?t[0]-(r(t[0],t[0],t[1],t[1],-n)-t[0]):e>1?t[i]-(r(t[i],t[i],t[i-1],t[i-1],n-i)-t[i]):r(t[o?o-1:0],t[o],t[i<o+1?i:o+1],t[i<o+2?i:o+2],n-o)},Utils:{Linear:function(t,e,i){return(e-t)*i+t},Bernstein:function(t,e){var i=TWEEN.Interpolation.Utils.Factorial;return i(t)/i(e)/i(t-e)},Factorial:function(){var t=[1];return function(e){var i=1;if(t[e])return t[e];for(var n=e;n>1;n--)i*=n;return t[e]=i,i}}(),CatmullRom:function(t,e,i,n,o){var r=.5*(i-t),a=.5*(n-e),s=o*o;return(2*e-2*i+r+a)*(o*s)+(-3*e+3*i-2*r-a)*s+r*o+e}}},function(t){"function"==typeof define&&define.amd?define([],function(){return TWEEN}):"undefined"!=typeof module&&"object"==typeof exports?module.exports=TWEEN:void 0!==t&&(t.TWEEN=TWEEN)}(this),THREE.OrbitControls=function(t,e){this.object=t,this.domElement=void 0!==e?e:document,this.frameId,this.enabled=!0,this.target=new THREE.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.noRotate=!1,this.rotateSpeed=-.15,this.noPan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.momentumDampingFactor=.9,this.momentumScalingFactor=-.005,this.momentumKeydownFactor=20,this.minFov=30,this.maxFov=120,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};var i,n,o,r,a,s,h,c=this,l=new THREE.Vector2,u=new THREE.Vector2,d=new THREE.Vector2,p=new THREE.Vector2,f=new THREE.Vector2,E=new THREE.Vector2,m=new THREE.Vector3,v=new THREE.Vector3,g=new THREE.Vector2,y=new THREE.Vector2,N=new THREE.Vector2,w=0,b=0,L=1,S=new THREE.Vector3,O=new THREE.Vector3,A=new THREE.Quaternion,P=0,T=0,R=!1,x={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},M=x.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom;var I=(new THREE.Quaternion).setFromUnitVectors(t.up,new THREE.Vector3(0,1,0)),C=I.clone().inverse(),D={type:"change"},H={type:"start"},_={type:"end"};function V(){return 2*Math.PI/60/60*c.autoRotateSpeed}function U(){return Math.pow(.95,c.zoomSpeed)}function k(t){if(!1!==c.enabled){t.preventDefault();var e=c.domElement===document?c.domElement.body:c.domElement;if(M===x.ROTATE){if(!0===c.noRotate)return;u.set(t.clientX,t.clientY),d.subVectors(u,l),c.rotateLeft(2*Math.PI*d.x/e.clientWidth*c.rotateSpeed),c.rotateUp(2*Math.PI*d.y/e.clientHeight*c.rotateSpeed),l.copy(u),o&&(P=t.clientX-o.clientX,T=t.clientY-o.clientY),o=t}else if(M===x.DOLLY){if(!0===c.noZoom)return;y.set(t.clientX,t.clientY),N.subVectors(y,g),N.y>0?c.dollyIn():N.y<0&&c.dollyOut(),g.copy(y)}else if(M===x.PAN){if(!0===c.noPan)return;f.set(t.clientX,t.clientY),E.subVectors(f,p),c.pan(E.x,E.y),p.copy(f)}M!==x.NONE&&c.update()}}function j(){R=!0,o=void 0,!1!==c.enabled&&(document.removeEventListener("mousemove",k,!1),document.removeEventListener("mouseup",j,!1),c.dispatchEvent(_),M=x.NONE)}function B(t){if(!1!==c.enabled&&!0!==c.noZoom&&M===x.NONE){t.preventDefault(),t.stopPropagation();var e=0;void 0!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),e>0?(c.object.fov=c.object.fov<c.maxFov?c.object.fov+1:c.maxFov,c.object.updateProjectionMatrix()):e<0&&(c.object.fov=c.object.fov>c.minFov?c.object.fov-1:c.minFov,c.object.updateProjectionMatrix()),c.update(),c.dispatchEvent(D),c.dispatchEvent(H),c.dispatchEvent(_)}}this.setLastQuaternion=function(t){A.copy(t),c.object.quaternion.copy(t)},this.getLastPosition=function(){return O},this.rotateLeft=function(t){void 0===t&&(t=V()),b-=t},this.rotateUp=function(t){void 0===t&&(t=V()),w-=t},this.panLeft=function(t){var e=this.object.matrix.elements;m.set(e[0],e[1],e[2]),m.multiplyScalar(-t),S.add(m)},this.panUp=function(t){var e=this.object.matrix.elements;m.set(e[4],e[5],e[6]),m.multiplyScalar(t),S.add(m)},this.pan=function(t,e){var i=c.domElement===document?c.domElement.body:c.domElement;if(c.object instanceof THREE.PerspectiveCamera){var n=c.object.position.clone().sub(c.target).length();n*=Math.tan(c.object.fov/2*Math.PI/180),c.panLeft(2*t*n/i.clientHeight),c.panUp(2*e*n/i.clientHeight)}else c.object instanceof THREE.OrthographicCamera?(c.panLeft(t*(c.object.right-c.object.left)/i.clientWidth),c.panUp(e*(c.object.top-c.object.bottom)/i.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.momentum=function(){R&&(Math.abs(P)<1e-4&&Math.abs(T)<1e-4?R=!1:(T*=this.momentumDampingFactor,P*=this.momentumDampingFactor,b-=this.momentumScalingFactor*P,w-=this.momentumScalingFactor*T))},this.dollyIn=function(t){void 0===t&&(t=U()),c.object instanceof THREE.PerspectiveCamera?L/=t:c.object instanceof THREE.OrthographicCamera?(c.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*t)),c.object.updateProjectionMatrix(),c.dispatchEvent(D)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.dollyOut=function(t){void 0===t&&(t=U()),c.object instanceof THREE.PerspectiveCamera?L*=t:c.object instanceof THREE.OrthographicCamera?(c.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/t)),c.object.updateProjectionMatrix(),c.dispatchEvent(D)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.update=function(t){var e=this.object.position;v.copy(e).sub(this.target),v.applyQuaternion(I),i=Math.atan2(v.x,v.z),n=Math.atan2(Math.sqrt(v.x*v.x+v.z*v.z),v.y),this.autoRotate&&M===x.NONE&&this.rotateLeft(V()),this.momentum(),i+=b,n+=w,i=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,i)),n=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,n)),n=Math.max(1e-7,Math.min(Math.PI-1e-7,n));var o=v.length()*L;o=Math.max(this.minDistance,Math.min(this.maxDistance,o)),this.target.add(S),v.x=o*Math.sin(n)*Math.sin(i),v.y=o*Math.cos(n),v.z=o*Math.sin(n)*Math.cos(i),v.applyQuaternion(C),e.copy(this.target).add(v),this.object.lookAt(this.target),b=0,w=0,L=1,S.set(0,0,0),(O.distanceToSquared(this.object.position)>1e-7||8*(1-A.dot(this.object.quaternion))>1e-7)&&(!0!==t&&this.dispatchEvent(D),O.copy(this.object.position),A.copy(this.object.quaternion))},this.reset=function(){M=x.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(D),this.update()},this.getPolarAngle=function(){return n},this.getAzimuthalAngle=function(){return i},this.domElement.addEventListener("mousedown",function(t){if(R=!1,P=T=0,!1!==c.enabled){if(t.preventDefault(),t.button===c.mouseButtons.ORBIT){if(!0===c.noRotate)return;M=x.ROTATE,l.set(t.clientX,t.clientY)}else if(t.button===c.mouseButtons.ZOOM){if(!0===c.noZoom)return;M=x.DOLLY,g.set(t.clientX,t.clientY)}else if(t.button===c.mouseButtons.PAN){if(!0===c.noPan)return;M=x.PAN,p.set(t.clientX,t.clientY)}M!==x.NONE&&(document.addEventListener("mousemove",k,!1),document.addEventListener("mouseup",j,!1),c.dispatchEvent(H)),c.update()}},!1),this.domElement.addEventListener("mousewheel",B,!1),this.domElement.addEventListener("DOMMouseScroll",B,!1),this.domElement.addEventListener("touchstart",function(t){if(R=!1,P=T=0,!1!==c.enabled){switch(t.touches.length){case 1:if(!0===c.noRotate)return;M=x.TOUCH_ROTATE,l.set(t.touches[0].pageX,t.touches[0].pageY);break;case 2:if(!0===c.noZoom)return;M=x.TOUCH_DOLLY;var e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY;Math.sqrt(e*e+i*i);break;case 3:if(!0===c.noPan)return;M=x.TOUCH_PAN,p.set(t.touches[0].pageX,t.touches[0].pageY);break;default:M=x.NONE}M!==x.NONE&&c.dispatchEvent(H)}},!1),this.domElement.addEventListener("touchend",function(){R=!0,o=void 0,!1!==c.enabled&&(c.dispatchEvent(_),M=x.NONE)},!1),this.domElement.addEventListener("touchmove",function(t){if(!1!==c.enabled){t.preventDefault(),t.stopPropagation();var e=c.domElement===document?c.domElement.body:c.domElement;switch(t.touches.length){case 1:if(!0===c.noRotate)return;if(M!==x.TOUCH_ROTATE)return;u.set(t.touches[0].pageX,t.touches[0].pageY),d.subVectors(u,l),c.rotateLeft(2*Math.PI*d.x/e.clientWidth*c.rotateSpeed),c.rotateUp(2*Math.PI*d.y/e.clientHeight*c.rotateSpeed),l.copy(u),o&&(P=t.touches[0].pageX-o.pageX,T=t.touches[0].pageY-o.pageY),o={pageX:t.touches[0].pageX,pageY:t.touches[0].pageY},c.update();break;case 2:if(!0===c.noZoom)return;if(M!==x.TOUCH_DOLLY)return;var i=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY;Math.sqrt(i*i+n*n),t.scale<1?(c.object.fov=c.object.fov<c.maxFov?c.object.fov+1:c.maxFov,c.object.updateProjectionMatrix()):t.scale>1&&(c.object.fov=c.object.fov>c.minFov?c.object.fov-1:c.minFov,c.object.updateProjectionMatrix()),c.update(),c.dispatchEvent(D);break;case 3:if(!0===c.noPan)return;if(M!==x.TOUCH_PAN)return;f.set(t.touches[0].pageX,t.touches[0].pageY),E.subVectors(f,p),c.pan(E.x,E.y),p.copy(f),c.update();break;default:M=x.NONE}}},!1),window.addEventListener("keyup",function(t){switch(t.keyCode){case c.keys.UP:r=!1;break;case c.keys.BOTTOM:a=!1;break;case c.keys.LEFT:s=!1;break;case c.keys.RIGHT:h=!1}},!1),window.addEventListener("keydown",function(t){if(!1!==c.enabled&&!0!==c.noKeys&&!0!==c.noRotate){switch(t.keyCode){case c.keys.UP:r=!0;break;case c.keys.BOTTOM:a=!0;break;case c.keys.LEFT:s=!0;break;case c.keys.RIGHT:h=!0}(r||a||s||h)&&(R=!0,r&&(T=-c.rotateSpeed*c.momentumKeydownFactor),a&&(T=c.rotateSpeed*c.momentumKeydownFactor),s&&(P=-c.rotateSpeed*c.momentumKeydownFactor),h&&(P=c.rotateSpeed*c.momentumKeydownFactor))}},!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,THREE.DeviceOrientationControls=function(t){var e=this;this.object=t,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alpha=0,this.alphaOffsetAngle=0;var i,n,o,r,a=function(t){e.deviceOrientation=t},s=function(){e.screenOrientation=window.orientation||0},h=(i=new THREE.Vector3(0,0,1),n=new THREE.Euler,o=new THREE.Quaternion,r=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),function(t,e,a,s,h){n.set(a,e,-s,"YXZ"),t.setFromEuler(n),t.multiply(r),t.multiply(o.setFromAxisAngle(i,-h))});this.connect=function(){s(),window.addEventListener("orientationchange",s,!1),window.addEventListener("deviceorientation",a,!1),e.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",s,!1),window.removeEventListener("deviceorientation",a,!1),e.enabled=!1},this.update=function(){if(!1!==e.enabled){var t=e.deviceOrientation.alpha?THREE.Math.degToRad(e.deviceOrientation.alpha)+this.alphaOffsetAngle:0,i=e.deviceOrientation.beta?THREE.Math.degToRad(e.deviceOrientation.beta):0,n=e.deviceOrientation.gamma?THREE.Math.degToRad(e.deviceOrientation.gamma):0,o=e.screenOrientation?THREE.Math.degToRad(e.screenOrientation):0;h(e.object.quaternion,t,i,n,o),this.alpha=t}},this.updateAlphaOffsetAngle=function(t){this.alphaOffsetAngle=t,this.update()},this.dispose=function(){this.disconnect()},this.connect()},THREE.DeviceOrientationControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.DeviceOrientationControls.prototype.constructor=THREE.DeviceOrientationControls,THREE.BendModifier=function(){},THREE.BendModifier.prototype={constructor:THREE.BendModifier,set:function(t,e,i){return this.direction=new THREE.Vector3,this.direction.copy(t),this.axis=new THREE.Vector3,this.axis.copy(e),this.angle=i,this},_sign:function(t){return 0>t?-1:0<t?1:0},_cosh:function(t){return(Math.exp(t)+Math.exp(-t))/2},_sinhInverse:function(t){return Math.log(Math.abs(t)+Math.sqrt(t*t+1))},modify:function(t){var e=new THREE.Vector3;e.crossVectors(this.direction,this.axis);var i=new THREE.Matrix4;i.set(e.x,e.y,e.z,0,this.direction.x,this.direction.y,this.direction.z,0,this.axis.x,this.axis.y,this.axis.z,0,0,0,0,1).transpose();for(var n=(new THREE.Matrix4).getInverse(i),o=[],r=[],a=[],s=0,h=0,c=0,l=0,u=0;u<t.vertices.length;u++)o[u]=new THREE.Vector3,o[u].copy(t.vertices[u]).applyMatrix4(n),o[u].x>s&&(s=o[u].x),o[u].x<h&&(h=o[u].x),o[u].y>c&&(c=o[u].y),o[u].y<l&&(l=o[u].y);var d=s-h,p=c-l,f=2*this._sinhInverse(Math.tan(this.angle))/d,E=(s+h)/2,m=(c+l)/2;for(u=0;u<t.vertices.length;u++)r[u]=new THREE.Vector3,r[u].copy(o[u]),o[u].x=1*this._sign(o[u].x-E)/f*this._sinhInverse((o[u].x-E)*f);var v=2/f*this._sinhInverse(d/2*f),g=2*this._sinhInverse(Math.tan(this.angle))/v,y=new THREE.Vector3(v/2,-p/2,0);y.y=1/g*this._cosh(g*y.x)-1/g-p/2;var N=new THREE.Vector3(0,y.y+y.x/Math.tan(this.angle),0);for(u=0;u<t.vertices.length;u++){var w=1*this._sign(r[u].x-E)/f*this._sinhInverse((r[u].x-E)*f),b=1/g*this._cosh(g*w)-1/g,L=new THREE.Vector3(N.x-w,N.y-(b-p/2),N.z).normalize(),S=new THREE.Vector3;S.addVectors(new THREE.Vector3(w,b-p/2,r[u].z),L.multiplyScalar(r[u].y+p/2)),o[u].x=S.x,o[u].y=S.y}var O=E*v/d;for(u=0;u<t.vertices.length;u++){var A=new THREE.Vector3(E,m,r[u].z);(new THREE.Vector3).subVectors(r[u],A),(new THREE.Vector3).subVectors(o[u],A),a[u]=Math.acos(1/this._cosh(f*o[u].x))*this._sign(o[u].x),o[u].x=o[u].x+O,t.vertices[u].copy(o[u].applyMatrix4(i))}t.computeFaceNormals(),t.verticesNeedUpdate=!0,t.normalsNeedUpdate=!0;for(var P=["a","b","c","d"],T=0,R=t.faces.length;T<R;T++){var x=t.faces[T];if(void 0!==x.vertexNormals)for(var M=0,I=x.vertexNormals.length;M<I;M++){var C=a[x[P[M]]],D=this.axis.x,H=this.axis.y,_=this.axis.z,V=new THREE.Matrix3;V.set(Math.cos(C)+(1-Math.cos(C))*D*D,(1-Math.cos(C))*D*H-Math.sin(C)*_,(1-Math.cos(C))*D*_+Math.sin(C)*H,(1-Math.cos(C))*H*D+Math.sin(C)*_,Math.cos(C)+(1-Math.cos(C))*H*H,(1-Math.cos(C))*H*_-Math.sin(C)*D,(1-Math.cos(C))*_*D-Math.sin(C)*H,(1-Math.cos(C))*_*H+Math.sin(C)*D,Math.cos(C)+(1-Math.cos(C))*_*_),x.vertexNormals[M].applyMatrix3(V)}}return this}},THREE.CardboardEffect=function(t){var e=new THREE.OrthographicCamera(-1,1,1,-1,0,1),i=new THREE.Scene,n=new THREE.StereoCamera;n.aspect=.5;var o={minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat},r=new THREE.WebGLRenderTarget(512,512,o);r.scissorTest=!0,r.texture.generateMipmaps=!1;var a=new THREE.Vector2(.441,.156),s=new THREE.PlaneBufferGeometry(1,1,10,20).removeAttribute("normal").toNonIndexed(),h=s.attributes.position.array,c=s.attributes.uv.array;s.attributes.position.count*=2,s.attributes.uv.count*=2;var l=new Float32Array(2*h.length);l.set(h),l.set(h,h.length);var u=new Float32Array(2*c.length);u.set(c),u.set(c,c.length);for(var d=new THREE.Vector2,p=h.length/3,f=0,E=l.length/3;f<E;f++){d.x=l[3*f+0],d.y=l[3*f+1];var m=d.dot(d),v=1.5+(a.x+a.y*m)*m,g=f<p?0:1;l[3*f+0]=d.x/v*1.5-.5+g,l[3*f+1]=d.y/v*3,u[2*f]=.5*(u[2*f]+g)}s.attributes.position.array=l,s.attributes.uv.array=u;var y=new THREE.MeshBasicMaterial({map:r.texture}),N=new THREE.Mesh(s,y);i.add(N),this.setSize=function(e,i){t.setSize(e,i);var n=t.getPixelRatio();r.setSize(e*n,i*n)},this.render=function(o,a){o.updateMatrixWorld(),null===a.parent&&a.updateMatrixWorld(),n.update(a);var s=r.width/2,h=r.height;r.scissor.set(0,0,s,h),r.viewport.set(0,0,s,h),t.render(o,n.cameraL,r),r.scissor.set(s,0,s,h),r.viewport.set(s,0,s,h),t.render(o,n.cameraR,r),t.render(i,e)}},THREE.StereoEffect=function(t){var e=new THREE.StereoCamera;e.aspect=.5,this.setEyeSeparation=function(t){e.eyeSep=t},this.setSize=function(e,i){t.setSize(e,i)},this.render=function(i,n){i.updateMatrixWorld(),null===n.parent&&n.updateMatrixWorld(),e.update(n);var o=t.getSize();t.autoClear&&t.clear(),t.setScissorTest(!0),t.setScissor(0,0,o.width/2,o.height),t.setViewport(0,0,o.width/2,o.height),t.render(i,e.cameraL),t.setScissor(o.width/2,0,o.width/2,o.height),t.setViewport(o.width/2,0,o.width/2,o.height),t.render(i,e.cameraR),t.setScissorTest(!1)}};var GSVPANO=GSVPANO||{};GSVPANO.PanoLoader=function(t){"use strict";var e,i,n=t||{},o=new google.maps.StreetViewService,r=0,a=0,s=[],h=[],c=0,l=0,u=[1,2,4,7,13,26],d=[1,1,2,4,7,13],p=[416,832,1664,3328,6656,13312],f=[416,416,832,1664,3328,6656],E=null;try{var m=document.createElement("canvas");null==(E=m.getContext("experimental-webgl"))&&(E=m.getContext("webgl"))}catch(t){}var v=1024,g=1024;if(E){var y=Math.max(E.getParameter(E.MAX_TEXTURE_SIZE),6656);v=g=y}this.setProgress=function(t,e){this.onProgress&&this.onProgress({loaded:t,total:e})},this.throwError=function(t){this.onError?this.onError(t):console.error(t)},this.adaptTextureToZoom=function(){var t,i;t=p[e],i=f[e],c=Math.ceil(t/v),l=Math.ceil(i/g),s=[],h=[];for(var n=0;n<l;n++)for(var o=0;o<c;o++){var r=document.createElement("canvas");r.width=o<c-1?v:t-v*o,r.height=n<l-1?g:i-g*n,s.push(r),h.push(r.getContext("2d")),0}},this.composeFromTile=function(t,e,i){t*=512,e*=512;var n=Math.floor(t/v),o=Math.floor(e/g);t-=n*v,e-=o*g,h[o*c+n].drawImage(i,0,0,i.width,i.height,t,e,512,512),this.progress()},this.progress=function(){r++;Math.round(100*r/a);this.setProgress(r,a),r===a&&(this.canvas=s,this.panoId=i,this.zoom=e,this.onPanoramaLoad&&this.onPanoramaLoad(s[0]))},this.loadFromId=function(t){i=t,this.composePanorama()},this.composePanorama=function(){this.setProgress(0,1);var t=u[e],o=d[e];r=0,a=t*o;for(var s=this,h=0;h<o;h++)for(var c=0;c<t;c++){var l="https://geo0.ggpht.com/cbk?cb_client=maps_sv.tactile&authuser=0&hl=en&output=tile&zoom="+e+"&x="+c+"&y="+h+"&panoid="+i+"&nbt&fover=2";!function(t,e){if(n.useWebGL)var i=THREE.ImageUtils.loadTexture(l,null,function(){s.composeFromTile(t,e,i)});else{var o=new Image;o.addEventListener("load",function(){s.composeFromTile(t,e,this)}),o.crossOrigin="",o.src=l}}(c,h)}},this.load=function(t){this.loadPano(t)},this.loadPano=function(t){var e=this;o.getPanoramaById(t,function(t,n){n===google.maps.StreetViewStatus.OK?(e.result=t,e.onPanoramaData&&e.onPanoramaData(t),t.copyright,e.copyright=t.copyright,i=t.location.pano,e.location=location,e.composePanorama()):(e.onNoPanoramaData&&e.onNoPanoramaData(n),e.throwError("Could not retrieve panorama for the following reason: "+n))})},this.setZoom=function(t){e=t,this.adaptTextureToZoom()},this.setZoom(n.zoom||1)},function(){"use strict";PANOLENS.DataImageSource="assets/img/",PANOLENS.DataImage={Info:PANOLENS.DataImageSource+"pinI.png",Video:PANOLENS.DataImageSource+"pinV.png",Foto:PANOLENS.DataImageSource+"pinF.png",Audio:PANOLENS.DataImageSource+"pinA.png",SetaCima:PANOLENS.DataImageSource+"seta-cima.png",SetaDiaCimaDir:PANOLENS.DataImageSource+"seta-dia-cima-dir.png",SetaDir:PANOLENS.DataImageSource+"seta-dir.png",SetaDiaBaixoDir:PANOLENS.DataImageSource+"seta-dia-baixo-dir.png",SetaBaixo:PANOLENS.DataImageSource+"seta-baixo.png",SetaDiaBaixoEsq:PANOLENS.DataImageSource+"seta-dia-baixo-esq.png",SetaEsq:PANOLENS.DataImageSource+"seta-esq.png",SetaDiaCimaEsq:PANOLENS.DataImageSource+"seta-dia-cima-esq.png",FullscreenEnter:PANOLENS.DataImageSource+"fullscreen.png",FullscreenLeave:PANOLENS.DataImageSource+"fullscreen-exit.png",VideoPlay:PANOLENS.DataImageSource+"video-play.png",VideoPause:PANOLENS.DataImageSource+"pause.png",WhiteTile:PANOLENS.DataImageSource+"tiles.png",ReticleIdle:PANOLENS.DataImageSource+"reticle-idle.png",Setting:PANOLENS.DataImageSource+"setting.png",ChevronRight:PANOLENS.DataImageSource+"chevron-right.png",Check:PANOLENS.DataImageSource+"check.png",ViewIndicator:PANOLENS.DataImageSource+"view-indicator.svg",ReticleDwell:PANOLENS.DataImageSource+"reticle-animation.png"}}(),function(){"use strict";PANOLENS.Controls={ORBIT:0,DEVICEORIENTATION:1},PANOLENS.Modes={UNKNOWN:0,NORMAL:1,CARDBOARD:2,STEREO:3}}(),function(){"use strict";PANOLENS.Utils={},PANOLENS.Utils.checkTouchSupported=function(){return!!window&&("ontouchstart"in window||window.navigator.msMaxTouchPoints)}}(),function(){"use strict";PANOLENS.Utils.ImageLoader={},PANOLENS.Utils.ImageLoader.load=function(t,e,i,n){var o,r,a,s,h,c,l;for(var u in PANOLENS.DataImage)PANOLENS.DataImage.hasOwnProperty(u)&&t===PANOLENS.DataImage[u]&&(l=u);if(void 0!==(o=THREE.Cache.get(l||t)))return e&&setTimeout(function(){i&&i({loaded:1,total:1}),e(o)},0),o;function d(){h.revokeObjectURL(c.src),e&&e(c)}if(h=window.URL||window.webkitURL,c=document.createElementNS("http://www.w3.org/1999/xhtml","img"),THREE.Cache.add(l||t,c),0===t.indexOf("data:"))return c.addEventListener("load",d,!1),c.src=t,c;c.crossOrigin=void 0!==this.crossOrigin?this.crossOrigin:"",(r=new XMLHttpRequest).open("GET",t,!0),r.responseType="arraybuffer",r.onprogress=function(t){t.lengthComputable&&i&&i({loaded:t.loaded,total:t.total})},r.onloadend=function(t){a=new Uint8Array(this.response),s=new Blob([a]),c.addEventListener("load",d,!1),c.src=h.createObjectURL(s)},r.send(null)},THREE.Cache.enabled=!0}(),function(){"use strict";PANOLENS.Utils.TextureLoader={},PANOLENS.Utils.TextureLoader.load=function(t,e,i,n){var o=new THREE.Texture;return PANOLENS.Utils.ImageLoader.load(t,function(t){o.image=t,o.needsUpdate=!0,e&&e(o)},i,n),o}}(),function(){"use strict";PANOLENS.Utils.CubeTextureLoader={},PANOLENS.Utils.CubeTextureLoader.load=function(t,e,i,n){var o,r,a,s,h;return o=new THREE.CubeTexture([]),r=0,a={},s={},t.map(function(t,c){PANOLENS.Utils.ImageLoader.load(t,function(t){o.images[c]=t,6===++r&&(o.needsUpdate=!0,e&&e(o))},function(t){a[c]={loaded:t.loaded,total:t.total},s.loaded=0,s.total=0,h=0;for(var e in a)h++,s.loaded+=a[e].loaded,s.total+=a[e].total;h<6&&(s.total=s.total/h*6),i&&i(s)},n)}),o}}(),PANOLENS.StereographicShader={uniforms:{tDiffuse:{value:new THREE.Texture},resolution:{value:1},transform:{value:new THREE.Matrix4},zoom:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float resolution;","uniform mat4 transform;","uniform float zoom;","varying vec2 vUv;","const float PI = 3.141592653589793;","void main(){","vec2 position = -1.0 +  2.0 * vUv;","position *= vec2( zoom * resolution, zoom * 0.5 );","float x2y2 = position.x * position.x + position.y * position.y;","vec3 sphere_pnt = vec3( 2. * position, x2y2 - 1. ) / ( x2y2 + 1. );","sphere_pnt = vec3( transform * vec4( sphere_pnt, 1.0 ) );","vec2 sampleUV = vec2(","(atan(sphere_pnt.y, sphere_pnt.x) / PI + 1.0) * 0.5,","(asin(sphere_pnt.z) / PI + 0.5)",");","gl_FragColor = texture2D( tDiffuse, sampleUV );","}"].join("\n")},function(){"use strict";PANOLENS.Panorama=function(t,e){THREE.Mesh.call(this),this.type="panorama",this.ImageQualityLow=1,this.ImageQualityFair=2,this.ImageQualityMedium=3,this.ImageQualityHigh=4,this.ImageQualitySuperHigh=5,this.animationDuration=1e3,this.defaultInfospotSize=350,this.container=void 0,this.loaded=!1,this.linkedSpots=[],this.isInfospotVisible=!1,this.linkingImageURL=void 0,this.linkingImageScale=void 0,this.geometry=t,this.material=e,this.material.side=THREE.DoubleSide,this.material.visible=!1,this.scale.x*=-1,this.infospotAnimation=new TWEEN.Tween(this).to({},this.animationDuration/2),this.addEventListener("load",this.fadeIn.bind(this)),this.addEventListener("panolens-container",this.setContainer.bind(this)),this.addEventListener("click",this.onClick.bind(this)),this.setupTransitions()},PANOLENS.Panorama.prototype=Object.create(THREE.Mesh.prototype),PANOLENS.Panorama.prototype.constructor=PANOLENS.Panorama,PANOLENS.Panorama.prototype.add=function(t){var e,i;if(e=this,arguments.length>1){for(var n=0;n<arguments.length;n++)this.add(arguments[n]);return this}t instanceof PANOLENS.Infospot?(i=t,t.dispatchEvent&&(this.container&&t.dispatchEvent({type:"panolens-container",container:this.container}),t.dispatchEvent({type:"panolens-infospot-focus",method:function(t,i,n){e.dispatchEvent({type:"panolens-viewer-handler",method:"tweenControlCenter",data:[t,i,n]})}}))):((i=new THREE.Object3D).scale.x=-1,i.scalePlaceHolder=!0,i.add(t)),THREE.Object3D.prototype.add.call(this,i)},PANOLENS.Panorama.prototype.load=function(){this.onLoad()},PANOLENS.Panorama.prototype.onClick=function(t){t.intersects&&0===t.intersects.length&&this.traverse(function(t){t.dispatchEvent({type:"dismiss"})})},PANOLENS.Panorama.prototype.setContainer=function(t){var e;t instanceof HTMLElement?e=t:t&&t.container&&(e=t.container),e&&(this.children.forEach(function(t){t instanceof PANOLENS.Infospot&&t.dispatchEvent&&t.dispatchEvent({type:"panolens-container",container:e})}),this.container=e)},PANOLENS.Panorama.prototype.onLoad=function(){this.loaded=!0,this.dispatchEvent({type:"load"})},PANOLENS.Panorama.prototype.onProgress=function(t){this.dispatchEvent({type:"progress",progress:t})},PANOLENS.Panorama.prototype.onError=function(){this.dispatchEvent({type:"error"})},PANOLENS.Panorama.prototype.getZoomLevel=function(){return window.innerWidth<=800?this.ImageQualityFair:window.innerWidth>800&&window.innerWidth<=1280?this.ImageQualityMedium:window.innerWidth>1280&&window.innerWidth<=1920?this.ImageQualityHigh:window.innerWidth>1920?this.ImageQualitySuperHigh:this.ImageQualityLow},PANOLENS.Panorama.prototype.updateTexture=function(t){this.material.map=t,this.material.needsUpdate=!0},PANOLENS.Panorama.prototype.toggleInfospotVisibility=function(t,e){var i,n;e=void 0!==e?e:0,i=this,n=void 0!==t?t:!this.isInfospotVisible,this.traverse(function(t){t instanceof PANOLENS.Infospot&&(n?t.show(e):t.hide(e))}),this.isInfospotVisible=n,this.infospotAnimation.onComplete(function(){i.dispatchEvent({type:"infospot-animation-complete",visible:n})}).delay(e).start()},PANOLENS.Panorama.prototype.setLinkingImage=function(t,e){this.linkingImageURL=t,this.linkingImageScale=e},PANOLENS.Panorama.prototype.title_pin=function(t,e){tooltipSpan=document.getElementById("tooltip-span"),tooltipSpan_in_out=$("#tooltip-span"),"saiu"==e?(tooltipSpan_in_out.fadeOut(50),tooltipSpan.innerHTML=null):"entrou"==e&&(tooltipSpan.innerHTML=t,tooltipSpan_in_out.fadeIn(50),window.onmousemove=function(t){var e=t.clientX,i=t.clientY;tooltipSpan.style.top=i+20+"px",tooltipSpan.style.left=e+20+"px"})},PANOLENS.Panorama.prototype.link=function(t,e,i,n,o){var r,a,s,h=this;this.visible=!0,e?(a=void 0!==i?i:void 0!==t.linkingImageScale?t.linkingImageScale:300,s=n||(t.linkingImageURL?t.linkingImageURL:PANOLENS.DataImage.SetaCima),(r=new PANOLENS.Infospot(a,s)).position.copy(e),r.toPanorama=t,r.addEventListener("hoverenter",function(){title_pin(o,"entrou"),null!=vmacess&&($("#tooltip-span").click(),$("#tooltip-span").vibrate())}),r.addEventListener("hoverleave",function(){title_pin(o,"saiu")}),r.addEventListener("click",function(){null!=vmacess&&($("#tooltip-span").click(),$("#tooltip-span").vibrate("long")),h.dispatchEvent({type:"panolens-viewer-handler",method:"setPanorama",data:t})}),this.linkedSpots.push(r),this.add(r),this.visible=!1):console.warn("Please specify infospot position for linking")},PANOLENS.Panorama.prototype.reset=function(){this.children.length=0},PANOLENS.Panorama.prototype.setupTransitions=function(){this.fadeInAnimation=new TWEEN.Tween(this.material).easing(TWEEN.Easing.Quartic.Out).onStart(function(){this.visible=!0,this.material.visible=!0,this.dispatchEvent({type:"enter-fade-start"})}.bind(this)),this.fadeOutAnimation=new TWEEN.Tween(this.material).easing(TWEEN.Easing.Quartic.Out).onComplete(function(){this.visible=!1,this.material.visible=!0,this.dispatchEvent({type:"leave-complete"})}.bind(this)),this.enterTransition=new TWEEN.Tween(this).easing(TWEEN.Easing.Quartic.Out).onComplete(function(){this.dispatchEvent({type:"enter-animation-complete"})}.bind(this)).start(),this.leaveTransition=new TWEEN.Tween(this).easing(TWEEN.Easing.Quartic.Out)},PANOLENS.Panorama.prototype.fadeIn=function(t){t=t>=0?t:this.animationDuration,this.fadeOutAnimation.stop(),this.fadeInAnimation.to({opacity:1},t).onComplete(function(){this.toggleInfospotVisibility(!0,t/2),this.dispatchEvent({type:"enter-fade-complete"})}.bind(this)).start()},PANOLENS.Panorama.prototype.fadeOut=function(t){t=t>=0?t:this.animationDuration,this.fadeInAnimation.stop(),this.fadeOutAnimation.to({opacity:0},t).start()},PANOLENS.Panorama.prototype.onEnter=function(){var t=this.animationDuration;this.leaveTransition.stop(),this.enterTransition.to({},t).onStart(function(){this.dispatchEvent({type:"enter-animation-start"}),this.loaded?this.fadeIn(t):this.load()}.bind(this)).start(),this.dispatchEvent({type:"enter"})},PANOLENS.Panorama.prototype.onLeave=function(){var t=this.animationDuration;this.enterTransition.stop(),this.leaveTransition.to({},t).onStart(function(){this.dispatchEvent({type:"leave-animation-start"}),this.fadeOut(t),this.toggleInfospotVisibility(!1)}.bind(this)).start(),this.dispatchEvent({type:"leave"})},PANOLENS.Panorama.prototype.dispose=function(){this.dispatchEvent({type:"panolens-viewer-handler",method:"onPanoramaDispose",data:this}),function t(e){for(var i=e.children.length-1;i>=0;i--)t(e.children[i]),e.remove(e.children[i]);e instanceof PANOLENS.Infospot&&e.dispose(),e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()}(this),this.parent&&this.parent.remove(this)}}(),function(){"use strict";PANOLENS.ImagePanorama=function(t,e){e=e||5e3;var i=new THREE.SphereGeometry(e,60,40),n=new THREE.MeshBasicMaterial({opacity:0,transparent:!0});PANOLENS.Panorama.call(this,i,n),this.src=t},PANOLENS.ImagePanorama.prototype=Object.create(PANOLENS.Panorama.prototype),PANOLENS.ImagePanorama.prototype.constructor=PANOLENS.ImagePanorama,PANOLENS.ImagePanorama.prototype.load=function(t){(t=t||this.src)?"string"==typeof t?PANOLENS.Utils.TextureLoader.load(t,this.onLoad.bind(this),this.onProgress.bind(this),this.onError.bind(this)):t instanceof HTMLImageElement&&this.onLoad(new THREE.Texture(t)):console.warn("Image source undefined")},PANOLENS.ImagePanorama.prototype.onLoad=function(t){t.minFilter=t.magFilter=THREE.LinearFilter,t.needsUpdate=!0,this.updateTexture(t),window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){PANOLENS.Panorama.prototype.onLoad.call(this)}.bind(this))}.bind(this))},PANOLENS.ImagePanorama.prototype.reset=function(){PANOLENS.Panorama.prototype.reset.call(this)}}(),function(){"use strict";PANOLENS.GoogleStreetviewPanorama=function(t,e){PANOLENS.ImagePanorama.call(this,void 0,e),this.panoId=t,this.gsvLoader=void 0,this.loadRequested=!1,this.setupGoogleMapAPI()},PANOLENS.GoogleStreetviewPanorama.prototype=Object.create(PANOLENS.ImagePanorama.prototype),PANOLENS.GoogleStreetviewPanorama.constructor=PANOLENS.GoogleStreetviewPanorama,PANOLENS.GoogleStreetviewPanorama.prototype.load=function(t){this.loadRequested=!0,(t=t||this.panoId||{})&&this.gsvLoader?this.loadGSVLoader(t):this.gsvLoader={}},PANOLENS.GoogleStreetviewPanorama.prototype.setupGoogleMapAPI=function(){var t=document.createElement("script");t.src="https://maps.googleapis.com/maps/api/js",t.onreadystatechange=this.setGSVLoader.bind(this),t.onload=this.setGSVLoader.bind(this),document.getElementsByTagName("head")[0].appendChild(t)},PANOLENS.GoogleStreetviewPanorama.prototype.setGSVLoader=function(){this.gsvLoader=new GSVPANO.PanoLoader,(this.gsvLoader==={}||this.loadRequested)&&this.load()},PANOLENS.GoogleStreetviewPanorama.prototype.getGSVLoader=function(){return this.gsvLoader},PANOLENS.GoogleStreetviewPanorama.prototype.loadGSVLoader=function(t){this.loadRequested=!1,this.gsvLoader.onProgress=this.onProgress.bind(this),this.gsvLoader.onPanoramaLoad=this.onLoad.bind(this),this.gsvLoader.setZoom(this.getZoomLevel()),this.gsvLoader.load(t),this.gsvLoader.loaded=!0},PANOLENS.GoogleStreetviewPanorama.prototype.onLoad=function(t){this.gsvLoader&&PANOLENS.ImagePanorama.prototype.onLoad.call(this,new THREE.Texture(t))},PANOLENS.GoogleStreetviewPanorama.prototype.reset=function(){this.gsvLoader=void 0,PANOLENS.ImagePanorama.prototype.reset.call(this)}}(),function(){"use strict";PANOLENS.CubePanorama=function(t,e){var i,n,o;this.images=t||[],e=e||1e4,i=JSON.parse(JSON.stringify(THREE.ShaderLib.cube)),n=new THREE.BoxGeometry(e,e,e),o=new THREE.ShaderMaterial({fragmentShader:i.fragmentShader,vertexShader:i.vertexShader,uniforms:i.uniforms,side:THREE.BackSide}),PANOLENS.Panorama.call(this,n,o)},PANOLENS.CubePanorama.prototype=Object.create(PANOLENS.Panorama.prototype),PANOLENS.CubePanorama.prototype.constructor=PANOLENS.CubePanorama,PANOLENS.CubePanorama.prototype.load=function(){PANOLENS.Utils.CubeTextureLoader.load(this.images,this.onLoad.bind(this),this.onProgress.bind(this),this.onError.bind(this))},PANOLENS.CubePanorama.prototype.onLoad=function(t){this.material.uniforms.tCube.value=t,PANOLENS.Panorama.prototype.onLoad.call(this)}}(),function(){"use strict";PANOLENS.BasicPanorama=function(t){var e=PANOLENS.DataImage.WhiteTile;PANOLENS.CubePanorama.call(this,[e,e,e,e,e,e],t)},PANOLENS.BasicPanorama.prototype=Object.create(PANOLENS.CubePanorama.prototype),PANOLENS.BasicPanorama.prototype.constructor=PANOLENS.BasicPanorama}(),function(){"use strict";PANOLENS.VideoPanorama=function(t,e,i){i=i||5e3;var n=new THREE.SphereGeometry(i,60,40),o=new THREE.MeshBasicMaterial({opacity:0,transparent:!0});PANOLENS.Panorama.call(this,n,o),this.src=t,this.options=e||{},this.options.playsinline=!1!==this.options.playsinline,this.videoElement=void 0,this.videoRenderObject=void 0,this.videoProgress=0,this.isIOS=/iPhone|iPad|iPod/i.test(navigator.userAgent),this.isMobile=this.isIOS||/Android|BlackBerry|Opera Mini|IEMobile/i.test(navigator.userAgent),this.addEventListener("leave",this.pauseVideo.bind(this)),this.addEventListener("enter-fade-start",this.resumeVideoProgress.bind(this)),this.addEventListener("video-toggle",this.toggleVideo.bind(this)),this.addEventListener("video-time",this.setVideoCurrentTime.bind(this))},PANOLENS.VideoPanorama.prototype=Object.create(PANOLENS.Panorama.prototype),PANOLENS.VideoPanorama.constructor=PANOLENS.VideoPanorama,PANOLENS.VideoPanorama.prototype.load=function(t,e){var i=this;t=t||this.src||"",e=e||this.options||{},this.videoElement=e.videoElement||document.createElement("video"),this.videoElement.muted=e.muted||!1,this.videoElement.loop=void 0===e.loop||e.loop,this.videoElement.autoplay=void 0!==e.autoplay&&e.autoplay,this.videoElement.crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:"anonymous",e.playsinline&&(this.videoElement.setAttribute("playsinline",""),this.videoElement.setAttribute("webkit-playsinline",""));var n=function(){i.onProgress({loaded:1,total:1}),i.setVideoTexture(i.videoElement),i.videoElement.autoplay&&i.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!1}),i.isMobile&&(i.videoElement.autoplay&&i.videoElement.muted?i.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!1}):i.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!0})),i.onLoad()};this.videoElement.readyState>2?n():(this.videoElement.querySelectorAll("source").length&&this.videoElement.src||(this.videoElement.src=t),this.videoElement.load()),this.videoElement.onloadeddata=n,this.videoElement.ontimeupdate=function(t){i.videoProgress=this.duration>=0?this.currentTime/this.duration:0,i.dispatchEvent({type:"panolens-viewer-handler",method:"onVideoUpdate",data:i.videoProgress})},this.videoElement.addEventListener("ended",function(){i.options.loop||(i.resetVideo(),i.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!0}))},!1)},PANOLENS.VideoPanorama.prototype.setVideoTexture=function(t){var e,i;t&&((e=new THREE.VideoTexture(t)).minFilter=THREE.LinearFilter,e.magFilter=THREE.LinearFilter,e.format=THREE.RGBFormat,i={video:t,videoTexture:e},this.isIOS&&enableInlineVideo(t),this.updateTexture(e),this.videoRenderObject=i)},PANOLENS.VideoPanorama.prototype.reset=function(){this.videoElement=void 0,PANOLENS.Panorama.prototype.reset.call(this)},PANOLENS.VideoPanorama.prototype.isVideoPaused=function(){return this.videoRenderObject.video.paused},PANOLENS.VideoPanorama.prototype.toggleVideo=function(){this.videoRenderObject&&this.videoRenderObject.video&&(this.isVideoPaused()?this.videoRenderObject.video.play():this.videoRenderObject.video.pause())},PANOLENS.VideoPanorama.prototype.setVideoCurrentTime=function(t){this.videoRenderObject&&this.videoRenderObject.video&&!Number.isNaN(t.percentage)&&1!==t.percentage&&(this.videoRenderObject.video.currentTime=this.videoRenderObject.video.duration*t.percentage,this.dispatchEvent({type:"panolens-viewer-handler",method:"onVideoUpdate",data:t.percentage}))},PANOLENS.VideoPanorama.prototype.playVideo=function(){this.videoRenderObject&&this.videoRenderObject.video&&this.isVideoPaused()&&this.videoRenderObject.video.play(),this.dispatchEvent({type:"play"})},PANOLENS.VideoPanorama.prototype.pauseVideo=function(){this.videoRenderObject&&this.videoRenderObject.video&&!this.isVideoPaused()&&this.videoRenderObject.video.pause(),this.dispatchEvent({type:"pause"})},PANOLENS.VideoPanorama.prototype.resumeVideoProgress=function(){this.videoElement.autoplay&&!this.isMobile?(this.playVideo(),this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!1})):(this.pauseVideo(),this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!0})),this.setVideoCurrentTime({percentage:this.videoProgress})},PANOLENS.VideoPanorama.prototype.resetVideo=function(){this.videoRenderObject&&this.videoRenderObject.video&&this.setVideoCurrentTime({percentage:0})},PANOLENS.VideoPanorama.prototype.isVideoMuted=function(){return this.videoRenderObject.video.muted},PANOLENS.VideoPanorama.prototype.muteVideo=function(){this.videoRenderObject&&this.videoRenderObject.video&&!this.isVideoMuted()&&(this.videoRenderObject.video.muted=!0),this.dispatchEvent({type:"volumechange"})},PANOLENS.VideoPanorama.prototype.unmuteVideo=function(){this.videoRenderObject&&this.videoRenderObject.video&&this.isVideoMuted()&&(this.videoRenderObject.video.muted=!1),this.dispatchEvent({type:"volumechange"})},PANOLENS.VideoPanorama.prototype.getVideoElement=function(){return this.videoRenderObject.video},PANOLENS.VideoPanorama.prototype.dispose=function(){this.resetVideo(),this.pauseVideo(),this.removeEventListener("leave",this.pauseVideo.bind(this)),this.removeEventListener("enter-fade-start",this.resumeVideoProgress.bind(this)),this.removeEventListener("video-toggle",this.toggleVideo.bind(this)),this.removeEventListener("video-time",this.setVideoCurrentTime.bind(this)),PANOLENS.Panorama.prototype.dispose.call(this)}}(),function(){"use strict";PANOLENS.EmptyPanorama=function(t){t=t||5e3;var e=new THREE.Geometry,i=new THREE.MeshBasicMaterial({color:0,opacity:1,transparent:!0});PANOLENS.Panorama.call(this,e,i)},PANOLENS.EmptyPanorama.prototype=Object.create(PANOLENS.Panorama.prototype),PANOLENS.EmptyPanorama.prototype.constructor=PANOLENS.EmptyPanorama}(),PANOLENS.LittlePlanet=function(t,e,i,n){"image"===(t=t||"image")&&PANOLENS.ImagePanorama.call(this,e,i),this.size=i||1e4,this.ratio=n||.5,this.EPS=1e-6,this.frameId,this.geometry=this.createGeometry(),this.material=this.createMaterial(this.size),this.dragging=!1,this.userMouse=new THREE.Vector2,this.quatA=new THREE.Quaternion,this.quatB=new THREE.Quaternion,this.quatCur=new THREE.Quaternion,this.quatSlerp=new THREE.Quaternion,this.vectorX=new THREE.Vector3(1,0,0),this.vectorY=new THREE.Vector3(0,1,0),this.addEventListener("window-resize",this.onWindowResize)},PANOLENS.LittlePlanet.prototype=Object.create(PANOLENS.ImagePanorama.prototype),PANOLENS.LittlePlanet.prototype.constructor=PANOLENS.LittlePlanet,PANOLENS.LittlePlanet.prototype.createGeometry=function(){return new THREE.PlaneGeometry(this.size,this.size*this.ratio)},PANOLENS.LittlePlanet.prototype.createMaterial=function(t){var e=PANOLENS.StereographicShader.uniforms;return e.zoom.value=t,new THREE.ShaderMaterial({uniforms:e,vertexShader:PANOLENS.StereographicShader.vertexShader,fragmentShader:PANOLENS.StereographicShader.fragmentShader})},PANOLENS.LittlePlanet.prototype.registerMouseEvents=function(){this.container.addEventListener("mousedown",this.onMouseDown.bind(this),!1),this.container.addEventListener("mousemove",this.onMouseMove.bind(this),!1),this.container.addEventListener("mouseup",this.onMouseUp.bind(this),!1),this.container.addEventListener("touchstart",this.onMouseDown.bind(this),!1),this.container.addEventListener("touchmove",this.onMouseMove.bind(this),!1),this.container.addEventListener("touchend",this.onMouseUp.bind(this),!1),this.container.addEventListener("mousewheel",this.onMouseWheel.bind(this),!1),this.container.addEventListener("DOMMouseScroll",this.onMouseWheel.bind(this),!1),this.container.addEventListener("contextmenu",this.onContextMenu.bind(this),!1)},PANOLENS.LittlePlanet.prototype.unregisterMouseEvents=function(){this.container.removeEventListener("mousedown",this.onMouseDown.bind(this),!1),this.container.removeEventListener("mousemove",this.onMouseMove.bind(this),!1),this.container.removeEventListener("mouseup",this.onMouseUp.bind(this),!1),this.container.removeEventListener("touchstart",this.onMouseDown.bind(this),!1),this.container.removeEventListener("touchmove",this.onMouseMove.bind(this),!1),this.container.removeEventListener("touchend",this.onMouseUp.bind(this),!1),this.container.removeEventListener("mousewheel",this.onMouseWheel.bind(this),!1),this.container.removeEventListener("DOMMouseScroll",this.onMouseWheel.bind(this),!1),this.container.removeEventListener("contextmenu",this.onContextMenu.bind(this),!1)},PANOLENS.LittlePlanet.prototype.onMouseDown=function(t){var e=t.clientX>=0?t.clientX:t.touches[0].clientX,i=t.clientY>=0?t.clientY:t.touches[0].clientY;switch(t.touches&&t.touches.length||1){case 1:this.dragging=!0,this.userMouse.set(e,i);break;case 2:var n=t.touches[0].pageX-t.touches[1].pageX,o=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(n*n+o*o);this.userMouse.pinchDistance=r}this.onUpdateCallback()},PANOLENS.LittlePlanet.prototype.onMouseMove=function(t){var e=t.clientX>=0?t.clientX:t.touches[0].clientX,i=t.clientY>=0?t.clientY:t.touches[0].clientY;switch(t.touches&&t.touches.length||1){case 1:var n=.4*THREE.Math.degToRad(e-this.userMouse.x),o=.4*THREE.Math.degToRad(i-this.userMouse.y);this.dragging&&(this.quatA.setFromAxisAngle(this.vectorY,n),this.quatB.setFromAxisAngle(this.vectorX,o),this.quatCur.multiply(this.quatA).multiply(this.quatB),this.userMouse.set(e,i));break;case 2:this.material.uniforms;var r=t.touches[0].pageX-t.touches[1].pageX,a=t.touches[0].pageY-t.touches[1].pageY,s=Math.sqrt(r*r+a*a);this.addZoomDelta(this.userMouse.pinchDistance-s)}},PANOLENS.LittlePlanet.prototype.onMouseUp=function(t){this.dragging=!1},PANOLENS.LittlePlanet.prototype.onMouseWheel=function(t){t.preventDefault(),t.stopPropagation();var e=0;void 0!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),this.addZoomDelta(e),this.onUpdateCallback()},PANOLENS.LittlePlanet.prototype.addZoomDelta=function(t){var e=this.material.uniforms,i=.1*this.size,n=10*this.size;e.zoom.value+=t,e.zoom.value<=i?e.zoom.value=i:e.zoom.value>=n&&(e.zoom.value=n)},PANOLENS.LittlePlanet.prototype.onUpdateCallback=function(){this.frameId=window.requestAnimationFrame(this.onUpdateCallback.bind(this)),this.quatSlerp.slerp(this.quatCur,.1),this.material.uniforms.transform.value.makeRotationFromQuaternion(this.quatSlerp),!this.dragging&&1-this.quatSlerp.clone().dot(this.quatCur)<this.EPS&&window.cancelAnimationFrame(this.frameId)},PANOLENS.LittlePlanet.prototype.reset=function(){this.quatCur.set(0,0,0,1),this.quatSlerp.set(0,0,0,1),this.onUpdateCallback()},PANOLENS.LittlePlanet.prototype.onLoad=function(){this.material.uniforms.resolution.value=this.container.clientWidth/this.container.clientHeight,this.registerMouseEvents(),this.onUpdateCallback(),this.dispatchEvent({type:"panolens-viewer-handler",method:"disableControl"})},PANOLENS.LittlePlanet.prototype.onLeave=function(){this.unregisterMouseEvents(),this.dispatchEvent({type:"panolens-viewer-handler",method:"enableControl",data:PANOLENS.Controls.ORBIT}),window.cancelAnimationFrame(this.frameId),PANOLENS.Panorama.prototype.onLeave.call(this)},PANOLENS.LittlePlanet.prototype.onWindowResize=function(){this.material.uniforms.resolution.value=this.container.clientWidth/this.container.clientHeight},PANOLENS.LittlePlanet.prototype.onContextMenu=function(){this.dragging=!1},PANOLENS.ImageLittlePlanet=function(t,e,i){PANOLENS.LittlePlanet.call(this,"image",t,e,i)},PANOLENS.ImageLittlePlanet.prototype=Object.create(PANOLENS.LittlePlanet.prototype),PANOLENS.ImageLittlePlanet.prototype.constructor=PANOLENS.ImageLittlePlanet,PANOLENS.ImageLittlePlanet.prototype.onLoad=function(t){this.updateTexture(t),PANOLENS.ImagePanorama.prototype.onLoad.call(this,t),PANOLENS.LittlePlanet.prototype.onLoad.call(this)},PANOLENS.ImageLittlePlanet.prototype.updateTexture=function(t){t.minFilter=t.magFilter=THREE.LinearFilter,this.material.uniforms.tDiffuse.value=t},PANOLENS.Reticle=function(t,e,i,n,o,r){t=t||16777215,this.autoSelect=void 0==e||e,this.dwellTime=o||1500,this.dwellSpriteAmount=r||45,this.dwellInterval=this.dwellTime/this.dwellSpriteAmount,this.IDLE=0,this.DWELLING=1,this.status,this.scaleIdle=new THREE.Vector3(.2,.2,1),this.scaleDwell=new THREE.Vector3(1,.8,1),this.textureLoaded=!1,this.idleImageUrl=i||PANOLENS.DataImage.ReticleIdle,this.dwellImageUrl=n||PANOLENS.DataImage.ReticleDwell,this.idleTexture=new THREE.Texture,this.dwellTexture=new THREE.Texture,THREE.Sprite.call(this,new THREE.SpriteMaterial({color:t,depthTest:!1})),this.currentTile=0,this.startTime=0,this.visible=!1,this.renderOrder=10,this.timerId,this.updateStatus(this.IDLE)},PANOLENS.Reticle.prototype=Object.create(THREE.Sprite.prototype),PANOLENS.Reticle.prototype.constructor=PANOLENS.Reticle,PANOLENS.Reticle.prototype.show=function(){this.visible=!0},PANOLENS.Reticle.prototype.hide=function(){this.visible=!1},PANOLENS.Reticle.prototype.loadTextures=function(){this.idleTexture=PANOLENS.Utils.TextureLoader.load(this.idleImageUrl),this.dwellTexture=PANOLENS.Utils.TextureLoader.load(this.dwellImageUrl),this.material.map=this.idleTexture,this.setupDwellSprite(this.dwellTexture),this.textureLoaded=!0},PANOLENS.Reticle.prototype.select=function(t){performance.now()-this.startTime>=this.dwellTime?(this.completeDwelling(),t()):this.autoSelect&&(this.updateDwelling(performance.now()),this.timerId=window.requestAnimationFrame(this.select.bind(this,t)))},PANOLENS.Reticle.prototype.clearTimer=function(){window.cancelAnimationFrame(this.timerId),this.timerId=null},PANOLENS.Reticle.prototype.setupDwellSprite=function(t){t.wrapS=THREE.RepeatWrapping,t.repeat.set(1/this.dwellSpriteAmount,1)},PANOLENS.Reticle.prototype.updateStatus=function(t){this.status=t,t===this.IDLE?(this.scale.copy(this.scaleIdle),this.material.map=this.idleTexture):t===this.DWELLING&&(this.scale.copy(this.scaleDwell),this.material.map=this.dwellTexture),this.currentTile=0,this.material.map.offset.x=0},PANOLENS.Reticle.prototype.startDwelling=function(t){this.autoSelect&&(this.startTime=performance.now(),this.updateStatus(this.DWELLING),this.select(t))},PANOLENS.Reticle.prototype.updateDwelling=function(t){var e=t-this.startTime;this.currentTile<=this.dwellSpriteAmount?(this.currentTile=Math.floor(e/this.dwellTime*this.dwellSpriteAmount),this.material.map.offset.x=this.currentTile/this.dwellSpriteAmount):this.updateStatus(this.IDLE)},PANOLENS.Reticle.prototype.cancelDwelling=function(){this.clearTimer(),this.updateStatus(this.IDLE)},PANOLENS.Reticle.prototype.completeDwelling=function(){this.clearTimer(),this.updateStatus(this.IDLE)},PANOLENS.Tile=function(t,e,i,n,o,r,a){this.parameters={width:t,height:e,widthSegments:i,heightSegments:n,forceDirection:o,forceAxis:r,forceAngle:a},t=t||10,e=e||5,i=i||1,n=n||1,o=o||new THREE.Vector3(0,0,1),r=r||new THREE.Vector3(0,1,0),a=void 0!==a?a:0,THREE.Mesh.call(this,new THREE.PlaneGeometry(t,e,i,n),new THREE.MeshBasicMaterial({color:16777215,transparent:!0})),this.bendModifier=new THREE.BendModifier,this.entity=void 0,this.animationDuration=500,this.animationFadeOut=void 0,this.animationFadeIn=void 0,this.animationTranslation=void 0,this.tweens={},0!==a&&this.bend(o,r,a),this.originalGeometry=this.geometry.clone()},PANOLENS.Tile.prototype=Object.create(THREE.Mesh.prototype),PANOLENS.Tile.prototype.constructor=PANOLENS.Tile,PANOLENS.Tile.prototype.clone=function(){var t,e=this.parameters;return(t=new PANOLENS.Tile(e.width,e.height,e.widthSegments,e.heightSegments,e.forceDirection,e.forceAxis,e.forceAngle)).setEntity(this.entity),t.material=this.material.clone(),t},PANOLENS.Tile.prototype.bend=function(t,e,i){this.bendModifier.set(t,e,i).modify(this.geometry)},PANOLENS.Tile.prototype.unbend=function(){var t=this.geometry;this.geometry=this.originalGeometry,this.originalGeometry=this.geometry.clone(),t.dispose(),t=null},PANOLENS.Tile.prototype.tween=function(t,e,i,n,o,r,a,s,h){return e=e||this,i=i||{},n=n||this.animationDuration,o=o||TWEEN.Easing.Exponential.Out,r=void 0!==r?r:0,a=a||null,s=s||null,h=h||null,this.tweens[t]||(this.tweens[t]=new TWEEN.Tween(e).to(i,n).easing(o).delay(r).onStart(a).onUpdate(s).onComplete(h)),this.tweens[t]},PANOLENS.Tile.prototype.ripple=function(t,e,i){t=t||2,e=e||200,i=i||TWEEN.Easing.Cubic.Out;var n=this,o=this.clone();new TWEEN.Tween(o.scale).to({x:t,y:t},e).easing(i).start(),new TWEEN.Tween(o.material).to({opacity:0},e).easing(i).onComplete(function(){n.remove(o),o.geometry.dispose(),o.material.dispose()}).start(),this.add(o)},PANOLENS.Tile.prototype.setEntity=function(t){this.entity=t},function(){"use strict";PANOLENS.TileGroup=function(t,e,i,n,o){var r=this;THREE.Object3D.call(this),this.tileArray=t||[],this.offset=void 0!==o?o:0,this.v_gap=void 0!==e?e:6,this.d_gap=void 0!==i?i:2,this.animationDuration=void 0!==n?n:200,this.animationEasing=TWEEN.Easing.Exponential.Out,this.visibleDelta=2,this.tileArray.map(function(t,e){t.image&&PANOLENS.Utils.TextureLoader.load(t.image,r.setTexture.bind(t)),t.position.set(0,e*-r.v_gap,e*-r.d_gap),t.originalPosition=t.position.clone(),t.setEntity(r),r.add(t)}),this.updateVisbility()},PANOLENS.TileGroup.prototype=Object.create(THREE.Object3D.prototype),PANOLENS.TileGroup.prototype.constructor=PANOLENS.TileGroup,PANOLENS.TileGroup.prototype.updateTexture=function(t){var e=this;t=t||[],this.children.map(function(i,n){i instanceof PANOLENS.Tile&&t[n]&&(PANOLENS.Utils.TextureLoader.load(t[n],e.setTexture.bind(i)),i.outline&&(i.outline.material.visible=!0))})},PANOLENS.TileGroup.prototype.updateAllTexture=function(t){if(this.updateTexture(t),t.length<this.children.length)for(var e=t.length;e<this.children.length;e++)this.children[e]instanceof PANOLENS.Tile&&(this.children[e].material.visible=!1,this.children[e].outline&&(this.children[e].outline.material.visible=!1))},PANOLENS.TileGroup.prototype.setTexture=function(t){t.minFilter=THREE.LinearFilter,t.magFilter=THREE.LinearFilter,this.material.visible=!0,this.material.map=t,this.material.needsUpdate=!0},PANOLENS.TileGroup.prototype.updateVisbility=function(){this.children[this.offset].visible=!0,new TWEEN.Tween(this.children[this.offset].material).to({opacity:1},this.animationDuration).easing(this.animationEasing).start(),this.children[this.offset].outline&&(this.children[this.offset].outline.visible=!0);for(var t=this.offset-1;t>=0;t--)-1!==this.tileArray.indexOf(this.children[t])&&(this.offset-t<=this.visibleDelta?(this.children[t].visible=!0,new TWEEN.Tween(this.children[t].material).to({opacity:1/(this.offset-t)*.5},this.animationDuration).easing(this.animationEasing).start()):this.children[t].visible=!1,this.children[t].outline&&(this.children[t].outline.visible=!1));for(t=this.offset+1;t<this.children.length;t++)-1!==this.tileArray.indexOf(this.children[t])&&(t-this.offset<=this.visibleDelta?(this.children[t].visible=!0,new TWEEN.Tween(this.children[t].material).to({opacity:1/(t-this.offset)*.5},this.animationDuration).easing(this.animationEasing).start()):this.children[t].visible=!1,this.children[t].outline&&(this.children[t].outline.visible=!1))},PANOLENS.TileGroup.prototype.scrollUp=function(t){var e,i=this.tileArray;if(t=void 0!==t?t:this.animationDuration,e=this.offset+1,this.offset<i.length-1&&i[this.offset+1].material.visible){for(var n=i.length-1;n>=0;n--)new TWEEN.Tween(i[n].position).to({y:(n-e)*-this.v_gap,z:Math.abs(n-e)*-this.d_gap},t).easing(this.animationEasing).start();this.offset++,this.updateVisbility(),this.dispatchEvent({type:"scroll",direction:"up"})}},PANOLENS.TileGroup.prototype.scrollDown=function(t){var e,i=this.tileArray;if(t=void 0!==t?t:this.animationDuration,e=this.offset-1,this.offset>0&&i[this.offset-1].material.visible){for(var n=0;n<i.length;n++)new TWEEN.Tween(i[n].position).to({y:(n-e)*-this.v_gap,z:Math.abs(n-e)*-this.d_gap},t).easing(this.animationEasing).start();this.offset--,this.updateVisbility(),this.dispatchEvent({type:"scroll",direction:"down"})}},PANOLENS.TileGroup.prototype.reset=function(){this.tileArray.map(function(t,e){t.position.copy(t.originalPosition)}),this.offset=0,this.updateVisbility()},PANOLENS.TileGroup.prototype.getIndex=function(){return this.offset},PANOLENS.TileGroup.prototype.getTileCount=function(){var t=0;return this.tileArray.map(function(e){e.material.visible&&t++}),t}}(),function(){"use strict";var t,e,i=[];PANOLENS.SpriteText=function(t,e,i,n,o){THREE.Object3D.call(this),this.text=t||"",this.maxWidth=e||2e3,this.color=i||16777215,this.opacity=void 0!==n?n:1,this.options=o||{},this.animationDuration=500,this.animationFadeOut=void 0,this.animationFadeIn=void 0,this.tweens={},this.addText(t)},PANOLENS.SpriteText.prototype=Object.create(THREE.Object3D.prototype),PANOLENS.SpriteText.prototype.constructor=PANOLENS.SpriteText,PANOLENS.SpriteText.prototype.generateTextGeometry=function(){},PANOLENS.SpriteText.prototype.generateSDFShader=function(){},PANOLENS.SpriteText.prototype.setBMFont=function(n,o,r){r.needsUpdate=!0,r.minFilter=THREE.LinearMipMapLinearFilter,r.magFilter=THREE.LinearFilter,r.generateMipmaps=!0,r.anisotropy=8,t=o,e=r;for(var a=i.length-1;a>=0;a--)i[a].target.addText(i[a].text);for(;i.length>0;)i.pop();n&&n()},PANOLENS.SpriteText.prototype.addText=function(n){if(t&&e){var o=new THREE.Object3D;this.options.text=n,this.options.font=t,this.options.width=this.maxWidth;var r=this.generateTextGeometry(this.options);r.computeBoundingBox(),r.computeBoundingSphere();var a=new THREE.RawShaderMaterial(this.generateSDFShader({map:e,side:THREE.DoubleSide,transparent:!0,color:this.color,opacity:this.opacity})),s=r.layout,h=new THREE.Mesh(r,a);h.entity=this,h.position.x=-s.width/2,h.position.y=1.035*s.height,o.scale.x=o.scale.y=-.05,o.add(h),this.mesh=h,this.add(o)}else i.push({target:this,text:n})},PANOLENS.SpriteText.prototype.update=function(t){var e;t=t||{},(e=this.mesh).geometry.update(t),e.position.x=-e.geometry.layout.width/2,e.position.y=1.035*e.geometry.layout.height},PANOLENS.SpriteText.prototype.tween=function(t,e,i,n,o,r,a,s,h){return e=e||this,i=i||{},n=n||this.animationDuration,o=o||TWEEN.Easing.Exponential.Out,r=void 0!==r?r:0,a=a||null,s=s||null,h=h||null,this.tweens[t]||(this.tweens[t]=new TWEEN.Tween(e).to(i,n).easing(o).delay(r).onStart(a).onUpdate(s).onComplete(h)),this.tweens[t]},PANOLENS.SpriteText.prototype.getLayout=function(){return this.mesh&&this.mesh.geometry&&this.mesh.geometry.layout||{}},PANOLENS.SpriteText.prototype.setEntity=function(t){this.entity=t}}(),PANOLENS.Widget=function(t){THREE.EventDispatcher.call(this),this.DEFAULT_TRANSITION="all 0.27s ease",this.TOUCH_ENABLED=PANOLENS.Utils.checkTouchSupported(),this.PREVENT_EVENT_HANDLER=function(t){t.preventDefault(),t.stopPropagation()},this.container=t,this.barElement,this.fullscreenElement,this.videoElement,this.settingElement,this.mainMenu,this.activeMainItem,this.activeSubMenu,this.mask},PANOLENS.Widget.prototype=Object.create(THREE.EventDispatcher.prototype),PANOLENS.Widget.prototype.constructor=PANOLENS.Widget,PANOLENS.Widget.prototype.addControlBar=function(){if(this.container){var t,e,i,n,o=this;n="linear-gradient(bottom, rgba(0,0,0,0.2), rgba(0,0,0,0))",(t=document.createElement("div")).style.width="100%",t.style.height="44px",t.style.float="left",t.style.transform=t.style.webkitTransform=t.style.msTransform="translateY(-100%)",t.style.background="-webkit-"+n,t.style.background="-moz-"+n,t.style.background="-o-"+n,t.style.background="-ms-"+n,t.style.background=n,t.style.transition=this.DEFAULT_TRANSITION,t.style.pointerEvents="none",t.isHidden=!1,t.toggle=function(){t.isHidden=!t.isHidden,e=t.isHidden?"translateY(0)":"translateY(-100%)",i=t.isHidden?0:1,t.style.transform=t.style.webkitTransform=t.style.msTransform=e,t.style.opacity=i};var r=this.createDefaultMenu();this.mainMenu=this.createMainMenu(r),t.appendChild(this.mainMenu);var a=this.createMask();this.mask=a,this.container.appendChild(a),t.dispose=function(){o.fullscreenElement&&(t.removeChild(o.fullscreenElement),o.fullscreenElement.dispose(),o.fullscreenElement=null),o.settingElement&&(t.removeChild(o.settingElement),o.settingElement.dispose(),o.settingElement=null),o.videoElement&&(t.removeChild(o.videoElement),o.videoElement.dispose(),o.videoElement=null)},this.container.appendChild(t),this.mask.addEventListener("mousemove",this.PREVENT_EVENT_HANDLER,!0),this.mask.addEventListener("mouseup",this.PREVENT_EVENT_HANDLER,!0),this.mask.addEventListener("mousedown",this.PREVENT_EVENT_HANDLER,!0),this.mask.addEventListener(o.TOUCH_ENABLED?"touchend":"click",function(t){t.preventDefault(),t.stopPropagation(),o.mask.hide(),o.settingElement.deactivate()},!1),this.addEventListener("control-bar-toggle",t.toggle),this.barElement=t}else console.warn("Widget container not set")},PANOLENS.Widget.prototype.createDefaultMenu=function(){var t,e=this;return t=function(t,i){return function(){e.dispatchEvent({type:"panolens-viewer-handler",method:t,data:i})}},[{title:"Controle",subMenu:[{title:this.TOUCH_ENABLED?"Touch":"Mouse",handler:t("enableControl",PANOLENS.Controls.ORBIT)},{title:"Sensor",handler:t("enableControl",PANOLENS.Controls.DEVICEORIENTATION)}]},{title:"Modo",subMenu:[{title:"Normal",handler:t("disableEffect")},{title:"culos VR",handler:t("enableEffect",PANOLENS.Modes.CARDBOARD)},{title:"Estereoscpico",handler:t("enableEffect",PANOLENS.Modes.STEREO)}]}]},PANOLENS.Widget.prototype.addControlButton=function(t){var e;switch(t){case"fullscreen":e=this.createFullscreenButton(),this.fullscreenElement=e;break;case"setting":e=this.createSettingButton(),this.settingElement=e;break;case"video":e=this.createVideoControl(),this.videoElement=e;break;default:return}e&&this.barElement.appendChild(e)},PANOLENS.Widget.prototype.createMask=function(){var t=document.createElement("div");return t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.width="100%",t.style.height="100%",t.style.background="transparent",t.style.display="none",t.show=function(){this.style.display="block"},t.hide=function(){this.style.display="none"},t},PANOLENS.Widget.prototype.createSettingButton=function(){var t,e=this;return(t=this.createCustomItem({style:{backgroundImage:'url("'+PANOLENS.DataImage.Setting+'")',webkitTransition:this.DEFAULT_TRANSITION,transition:this.DEFAULT_TRANSITION},onTap:function(t){t.preventDefault(),t.stopPropagation(),e.mainMenu.toggle(),this.activated?this.deactivate():this.activate()}})).activate=function(){this.style.transform="rotate3d(0,0,1,90deg)",this.activated=!0,e.mask.show()},t.deactivate=function(){this.style.transform="rotate3d(0,0,0,0)",this.activated=!1,e.mask.hide(),e.mainMenu&&e.mainMenu.visible&&e.mainMenu.hide(),e.activeSubMenu&&e.activeSubMenu.visible&&e.activeSubMenu.hide(),e.mainMenu&&e.mainMenu._width&&(e.mainMenu.changeSize(e.mainMenu._width),e.mainMenu.unslideAll())},t.activated=!1,t},PANOLENS.Widget.prototype.createFullscreenButton=function(){var t,e,i=this,n=!1,o=!0;if(e="panolens-style-addon",document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled){if(document.addEventListener("fullscreenchange",a,!1),document.addEventListener("webkitfullscreenchange",a,!1),document.addEventListener("mozfullscreenchange",a,!1),document.addEventListener("MSFullscreenChange",a,!1),t=this.createCustomItem({style:{backgroundImage:'url("'+PANOLENS.DataImage.FullscreenEnter+'")'},onTap:function(t){t.preventDefault(),t.stopPropagation(),o=!1,n?(document.exitFullscreen&&document.exitFullscreen(),document.msExitFullscreen&&document.msExitFullscreen(),document.mozCancelFullScreen&&document.mozCancelFullScreen(),document.webkitExitFullscreen&&document.webkitExitFullscreen(),n=!1):(i.container.requestFullscreen&&i.container.requestFullscreen(),i.container.msRequestFullscreen&&i.container.msRequestFullscreen(),i.container.mozRequestFullScreen&&i.container.mozRequestFullScreen(),i.container.webkitRequestFullscreen&&i.container.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT),n=!0),this.style.backgroundImage=n?'url("'+PANOLENS.DataImage.FullscreenLeave+'")':'url("'+PANOLENS.DataImage.FullscreenEnter+'")'}}),!document.querySelector(e)){var r=document.createElement("style");r.id=e,r.innerHTML=":-webkit-full-screen { width: 100% !important; height: 100% !important }",document.body.appendChild(r)}return t}function a(e){o&&(n=!n,t.style.backgroundImage=n?'url("'+PANOLENS.DataImage.FullscreenLeave+'")':'url("'+PANOLENS.DataImage.FullscreenEnter+'")'),i.dispatchEvent({type:"panolens-viewer-handler",method:"onWindowResize",data:!1}),o=!0}},PANOLENS.Widget.prototype.createVideoControl=function(){var t;return(t=document.createElement("span")).style.display="none",t.show=function(){t.style.display=""},t.hide=function(){t.style.display="none",t.controlButton.paused=!0,t.controlButton.update()},t.controlButton=this.createVideoControlButton(),t.seekBar=this.createVideoControlSeekbar(),t.appendChild(t.controlButton),t.appendChild(t.seekBar),t.dispose=function(){t.removeChild(t.controlButton),t.removeChild(t.seekBar),t.controlButton.dispose(),t.controlButton=null,t.seekBar.dispose(),t.seekBar=null},this.addEventListener("video-control-show",t.show),this.addEventListener("video-control-hide",t.hide),t},PANOLENS.Widget.prototype.createVideoControlButton=function(){var t,e=this;return(t=this.createCustomItem({style:{float:"left",backgroundImage:'url("'+PANOLENS.DataImage.VideoPlay+'")'},onTap:function(i){i.preventDefault(),i.stopPropagation(),e.dispatchEvent({type:"panolens-viewer-handler",method:"toggleVideoPlay",data:!this.paused}),this.paused=!this.paused,t.update()}})).paused=!0,t.update=function(t){this.paused=void 0!==t?t:this.paused,this.style.backgroundImage='url("'+(this.paused?PANOLENS.DataImage.VideoPlay:PANOLENS.DataImage.VideoPause)+'")'},t},PANOLENS.Widget.prototype.createVideoControlSeekbar=function(){var t,e,i,n,o,r,a=this,s=!1;function h(t){t.stopPropagation(),s=!0,n=t.clientX||t.changedTouches&&t.changedTouches[0].clientX,o=parseInt(e.style.width)/100,a.container.addEventListener("mousemove",c,!1),a.container.addEventListener("mouseup",l,!1),a.container.addEventListener("touchmove",c,!1),a.container.addEventListener("touchend",l,!1)}function c(e){var i;s&&(i=e.clientX||e.changedTouches&&e.changedTouches[0].clientX,r=(i-n)/t.clientWidth,r=(r=o+r)>1?1:r<0?0:r,t.setProgress(r),a.dispatchEvent({type:"panolens-viewer-handler",method:"setVideoCurrentTime",data:r}))}function l(t){t.stopPropagation(),s=!1,u()}function u(){a.container.removeEventListener("mousemove",c,!1),a.container.removeEventListener("mouseup",l,!1),a.container.removeEventListener("touchmove",c,!1),a.container.removeEventListener("touchend",l,!1)}return(e=document.createElement("div")).style.width="0%",e.style.height="100%",e.style.backgroundColor="#fff",(i=document.createElement("div")).style.float="right",i.style.width="14px",i.style.height="14px",i.style.transform="translate(7px, -5px)",i.style.borderRadius="50%",i.style.backgroundColor="#ddd",i.addEventListener("mousedown",h,!1),i.addEventListener("touchstart",h,!1),e.appendChild(i),(t=this.createCustomItem({style:{float:"left",width:"30%",height:"4px",marginTop:"20px",backgroundColor:"rgba(188,188,188,0.8)"},onTap:function(e){var n;e.preventDefault(),e.stopPropagation(),e.target!==i&&(n=e.changedTouches&&e.changedTouches.length>0?(e.changedTouches[0].pageX-e.target.getBoundingClientRect().left)/this.clientWidth:e.offsetX/this.clientWidth,a.dispatchEvent({type:"panolens-viewer-handler",method:"setVideoCurrentTime",data:n}),t.setProgress(e.offsetX/this.clientWidth))},onDispose:function(){u(),e=null,i=null}})).appendChild(e),t.setProgress=function(t){e.style.width=100*t+"%"},this.addEventListener("video-update",function(e){t.setProgress(e.percentage)}),t},PANOLENS.Widget.prototype.createMenuItem=function(t){var e=this,i=document.createElement("a");return i.textContent=t,i.style.display="block",i.style.padding="10px",i.style.textDecoration="none",i.style.cursor="pointer",i.style.pointerEvents="auto",i.style.transition=this.DEFAULT_TRANSITION,i.slide=function(t){this.style.transform="translateX("+(t?"":"-")+"100%)"},i.unslide=function(){this.style.transform="translateX(0)"},i.setIcon=function(t){this.icon&&(this.icon.style.backgroundImage="url("+t+")")},i.setSelectionTitle=function(t){this.selection&&(this.selection.textContent=t)},i.addSelection=function(t){var e=document.createElement("span");return e.style.fontSize="13px",e.style.fontWeight="300",e.style.float="right",this.selection=e,this.setSelectionTitle(t),this.appendChild(e),this},i.addIcon=function(t,e,i){t=t||PANOLENS.DataImage.ChevronRight,e=e||!1,i=i||!1;var n=document.createElement("span");return n.style.float=e?"left":"right",n.style.width="17px",n.style.height="17px",n.style["margin"+(e?"Right":"Left")]="12px",n.style.backgroundSize="cover",i&&(n.style.transform="rotateZ(180deg)"),this.icon=n,this.setIcon(t),this.appendChild(n),this},i.addSubMenu=function(t,i){return this.subMenu=e.createSubMenu(t,i),this},i.addEventListener("mouseenter",function(){this.style.backgroundColor="#e0e0e0"},!1),i.addEventListener("mouseleave",function(){this.style.backgroundColor="#fafafa"},!1),i},PANOLENS.Widget.prototype.createMenuItemHeader=function(t){var e=this.createMenuItem(t);return e.style.borderBottom="1px solid #333",e.style.paddingBottom="15px",e},PANOLENS.Widget.prototype.createMainMenu=function(t){var e=this,i=this.createMenu();function n(t){t.preventDefault(),t.stopPropagation();var i=e.mainMenu,n=this.subMenu;i.hide(),i.slideAll(),i.parentElement.appendChild(n),e.activeMainItem=this,e.activeSubMenu=n,window.requestAnimationFrame(function(){i.changeSize(n.clientWidth),n.show(),n.unslideAll()})}i._width=200,i.changeSize(i._width);for(var o=0;o<t.length;o++){var r=i.addItem(t[o].title);if(r.style.paddingLeft="20px",r.addIcon().addEventListener(e.TOUCH_ENABLED?"touchend":"click",n,!1),t[o].subMenu&&t[o].subMenu.length>0){var a=t[o].subMenu[0].title;r.addSelection(a).addSubMenu(t[o].title,t[o].subMenu)}}return i},PANOLENS.Widget.prototype.createSubMenu=function(t,e){var i,n=this,o=this.createMenu();function r(t){t.preventDefault(),t.stopPropagation(),(i=n.mainMenu).changeSize(i._width),i.unslideAll(),i.show(),o.slideAll(!0),o.hide(),"header"!==this.type&&(o.setActiveItem(this),n.activeMainItem.setSelectionTitle(this.textContent),this.handler&&this.handler())}o.items=e,o.activeItem,o.addHeader(t).addIcon(void 0,!0,!0).addEventListener(n.TOUCH_ENABLED?"touchend":"click",r,!1);for(var a=0;a<e.length;a++){var s=o.addItem(e[a].title);s.style.fontWeight=300,s.handler=e[a].handler,s.addIcon(" ",!0),s.addEventListener(n.TOUCH_ENABLED?"touchend":"click",r,!1),o.activeItem||o.setActiveItem(s)}return o.slideAll(!0),o},PANOLENS.Widget.prototype.createMenu=function(){var t,e=this,i=document.createElement("span");return(t=i.style).padding="5px 0",t.position="fixed",t.bottom="100%",t.right="14px",t.backgroundColor="#fafafa",t.fontFamily='"Montserrat", sans-serif',t.fontSize="14px",t.visibility="hidden",t.opacity=0,t.boxShadow="0 0 12pt rgba(0,0,0,0.25)",t.borderRadius="2px",t.overflow="hidden",t.willChange="width, height, opacity",t.pointerEvents="auto",t.transition=this.DEFAULT_TRANSITION,i.visible=!1,i.changeSize=function(t,e){t&&(this.style.width=t+"px"),e&&(this.style.height=e+"px")},i.show=function(){this.style.opacity=1,this.style.visibility="visible",this.visible=!0},i.hide=function(){this.style.opacity=0,this.style.visibility="hidden",this.visible=!1},i.toggle=function(){this.visible?this.hide():this.show()},i.slideAll=function(t){for(var e=0;e<i.children.length;e++)i.children[e].slide&&i.children[e].slide(t)},i.unslideAll=function(){for(var t=0;t<i.children.length;t++)i.children[t].unslide&&i.children[t].unslide()},i.addHeader=function(t){var i=e.createMenuItemHeader(t);return i.type="header",this.appendChild(i),i},i.addItem=function(t){var i=e.createMenuItem(t);return i.type="item",this.appendChild(i),i},i.setActiveItem=function(t){this.activeItem&&this.activeItem.setIcon(" "),t.setIcon(PANOLENS.DataImage.Check),this.activeItem=t},i.addEventListener("mousemove",this.PREVENT_EVENT_HANDLER,!0),i.addEventListener("mouseup",this.PREVENT_EVENT_HANDLER,!0),i.addEventListener("mousedown",this.PREVENT_EVENT_HANDLER,!0),i},PANOLENS.Widget.prototype.createCustomItem=function(t){var e=this,i=(t=t||{}).element||document.createElement("span");return i.style.cursor="pointer",i.style.float="right",i.style.width="44px",i.style.height="100%",i.style.backgroundSize="60%",i.style.backgroundRepeat="no-repeat",i.style.backgroundPosition="center",i.style.webkitUserSelect=i.style.MozUserSelect=i.style.userSelect="none",i.style.position="relative",i.style.pointerEvents="auto",i.addEventListener(e.TOUCH_ENABLED?"touchstart":"mouseenter",function(){i.style.filter=i.style.webkitFilter="drop-shadow(0 0 5px rgba(255,255,255,1))"}),i.addEventListener(e.TOUCH_ENABLED?"touchend":"mouseleave",function(){i.style.filter=i.style.webkitFilter=""}),i=this.mergeStyleOptions(i,t.style),t.onTap&&i.addEventListener(e.TOUCH_ENABLED?"touchend":"click",t.onTap,!1),i.dispose=function(){i.removeEventListener(e.TOUCH_ENABLED?"touchend":"click",t.onTap,!1),t.onDispose&&t.onDispose()},i},PANOLENS.Widget.prototype.mergeStyleOptions=function(t,e){e=e||{};for(var i in e)e.hasOwnProperty(i)&&(t.style[i]=e[i]);return t},PANOLENS.Widget.prototype.dispose=function(){this.barElement&&(this.container.removeChild(this.barElement),this.barElement.dispose(),this.barElement=null)},PANOLENS.Infospot=function(t,e,i){var n,o,r,a=this;t=t||300,e=e||PANOLENS.DataImage.Info,r=500,THREE.Sprite.call(this),this.type="infospot",this.animated=void 0===i||i,this.isHovering=!1,this.visible=!1,this.element,this.toPanorama,this.cursorStyle,this.mode=PANOLENS.Modes.UNKNOWN,this.scale.set(t,t,1),this.rotation.y=Math.PI,this.scaleFactor=1.3,this.container,this.HANDLER_FOCUS,PANOLENS.Utils.TextureLoader.load(e,function(e){e.wrapS=THREE.RepeatWrapping,e.repeat.x=-1,e.image.width=e.image.naturalWidth||64,e.image.height=e.image.naturalHeight||64,n=e.image.width/e.image.height,a.scale.set(n*t,t,1),o=a.scale.clone(),a.scaleUpAnimation=new TWEEN.Tween(a.scale).to({x:o.x*a.scaleFactor,y:o.y*a.scaleFactor},r).easing(TWEEN.Easing.Elastic.Out),a.scaleDownAnimation=new TWEEN.Tween(a.scale).to({x:o.x,y:o.y},r).easing(TWEEN.Easing.Elastic.Out),a.material.side=THREE.DoubleSide,a.material.map=e,a.material.depthTest=!1,a.material.needsUpdate=!0}),this.showAnimation=new TWEEN.Tween(this.material).to({opacity:1},r).onStart(function(){this.visible=!0}.bind(this)).easing(TWEEN.Easing.Quartic.Out),this.hideAnimation=new TWEEN.Tween(this.material).to({opacity:0},r).onComplete(function(){this.visible=!1}.bind(this)).easing(TWEEN.Easing.Quartic.Out),this.addEventListener("click",this.onClick),this.addEventListener("hover",this.onHover),this.addEventListener("hoverenter",this.onHoverStart),this.addEventListener("hoverleave",this.onHoverEnd),this.addEventListener("panolens-dual-eye-effect",this.onDualEyeEffect),this.addEventListener("panolens-container",this.setContainer.bind(this)),this.addEventListener("dismiss",this.onDismiss),this.addEventListener("panolens-infospot-focus",this.setFocusMethod)},PANOLENS.Infospot.prototype=Object.create(THREE.Sprite.prototype),PANOLENS.Infospot.prototype.setContainer=function(t){var e;t instanceof HTMLElement?e=t:t&&t.container&&(e=t.container),e&&this.element&&e.appendChild(this.element),this.container=e},PANOLENS.Infospot.prototype.getContainer=function(){return this.container},PANOLENS.Infospot.prototype.onClick=function(t){this.element&&this.getContainer()&&(this.onHoverStart(t),this.lockHoverElement())},PANOLENS.Infospot.prototype.onDismiss=function(t){this.element&&(this.unlockHoverElement(),this.onHoverEnd())},PANOLENS.Infospot.prototype.onHover=function(t){},PANOLENS.Infospot.prototype.onHoverStart=function(t){if(this.getContainer()){var e=this.cursorStyle||(this.mode===PANOLENS.Modes.NORMAL?"pointer":"default");this.isHovering=!0,this.container.style.cursor=e,this.animated&&(this.scaleDownAnimation&&this.scaleDownAnimation.stop(),this.scaleUpAnimation&&this.scaleUpAnimation.start()),this.element&&t.mouseEvent.clientX>=0&&t.mouseEvent.clientY>=0&&(this.mode===PANOLENS.Modes.CARDBOARD||this.mode===PANOLENS.Modes.STEREO?(this.element.style.display="none",this.element.left&&(this.element.left.style.display="block"),this.element.right&&(this.element.right.style.display="block"),this.element._width=this.element.left.clientWidth,this.element._height=this.element.left.clientHeight):(this.element.style.display="block",this.element.left&&(this.element.left.style.display="none"),this.element.right&&(this.element.right.style.display="none"),this.element._width=this.element.clientWidth,this.element._height=this.element.clientHeight))}},PANOLENS.Infospot.prototype.onHoverEnd=function(){this.getContainer()&&(this.isHovering=!1,this.container.style.cursor="default",this.animated&&(this.scaleUpAnimation&&this.scaleUpAnimation.stop(),this.scaleDownAnimation&&this.scaleDownAnimation.start()),this.element&&!this.element.locked&&(this.element.style.display="none",this.element.left&&(this.element.left.style.display="none"),this.element.right&&(this.element.right.style.display="none"),this.unlockHoverElement()))},PANOLENS.Infospot.prototype.onDualEyeEffect=function(t){var e,i,n;this.getContainer()&&(this.mode=t.mode,e=this.element,i=this.container.clientWidth/2,n=this.container.clientHeight/2,e&&(e.left&&e.right||(e.left=e.cloneNode(!0),e.right=e.cloneNode(!0)),this.mode===PANOLENS.Modes.CARDBOARD||this.mode===PANOLENS.Modes.STEREO?(e.left.style.display=e.style.display,e.right.style.display=e.style.display,e.style.display="none"):(e.style.display=e.left.style.display,e.left.style.display="none",e.right.style.display="none"),this.translateElement(i,n),this.container.appendChild(e.left),this.container.appendChild(e.right)))},PANOLENS.Infospot.prototype.translateElement=function(t,e){var i,n,o,r,a,s,h;this.element._width&&this.element._height&&this.getContainer()&&(h=this.container,i=t-(r=(o=this.element)._width/2),n=e-(a=o._height/2)-(s=void 0!==o.verticalDelta?o.verticalDelta:40),this.mode!==PANOLENS.Modes.CARDBOARD&&this.mode!==PANOLENS.Modes.STEREO||!o.left||!o.right||t===h.clientWidth/2&&e===h.clientHeight/2?this.setElementStyle("transform",o,"translate("+i+"px, "+n+"px)"):(i=h.clientWidth/4-r+(t-h.clientWidth/2),n=h.clientHeight/2-a-s+(e-h.clientHeight/2),this.setElementStyle("transform",o.left,"translate("+i+"px, "+n+"px)"),i+=h.clientWidth/2,this.setElementStyle("transform",o.right,"translate("+i+"px, "+n+"px)")))},PANOLENS.Infospot.prototype.setElementStyle=function(t,e,i){var n=e.style;"transform"===t&&(n.webkitTransform=n.msTransform=n.transform=i)},PANOLENS.Infospot.prototype.setText=function(t){this.element&&(this.element.textContent=t)},PANOLENS.Infospot.prototype.setCursorHoverStyle=function(t){this.cursorStyle=t},PANOLENS.Infospot.prototype.addHoverText=function(t,e){this.element||(this.element=document.createElement("div"),this.element.style.display="none",this.element.style.color="#fff",this.element.style.top=0,this.element.style.maxWidth="50%",this.element.style.maxHeight="50%",this.element.style.textShadow="0 0 3px #000000",this.element.style.fontFamily='"Montserrat", sans-serif',this.element.style.position="absolute",this.element.classList.add("panolens-infospot"),this.element.verticalDelta=void 0!==e?e:40),this.setText(t)},PANOLENS.Infospot.prototype.addHoverElement=function(t,e){this.element||(this.element=t.cloneNode(!0),this.element.style.display="none",this.element.style.top=0,this.element.style.position="absolute",this.element.classList.add("panolens-infospot"),this.element.verticalDelta=void 0!==e?e:40)},PANOLENS.Infospot.prototype.removeHoverElement=function(){this.element&&(this.element.left&&(this.container.removeChild(this.element.left),this.element.left=null),this.element.right&&(this.container.removeChild(this.element.right),this.element.right=null),this.container.removeChild(this.element),this.element=null)},PANOLENS.Infospot.prototype.lockHoverElement=function(){this.element&&(this.element.locked=!0)},PANOLENS.Infospot.prototype.unlockHoverElement=function(){this.element&&(this.element.locked=!1)},PANOLENS.Infospot.prototype.show=function(t){t=t||0,this.animated&&(this.hideAnimation&&this.hideAnimation.stop(),this.showAnimation&&this.showAnimation.delay(t).start())},PANOLENS.Infospot.prototype.hide=function(t){t=t||0,this.animated&&(this.showAnimation&&this.showAnimation.stop(),this.hideAnimation&&this.hideAnimation.delay(t).start())},PANOLENS.Infospot.prototype.setFocusMethod=function(t){t&&(this.HANDLER_FOCUS=t.method)},PANOLENS.Infospot.prototype.focus=function(t,e){this.HANDLER_FOCUS&&(this.HANDLER_FOCUS(this.position,t,e),this.onDismiss())},PANOLENS.Infospot.prototype.dispose=function(){this.removeHoverElement(),this.material.dispose(),this.parent&&this.parent.remove(this)},function(){"use strict";PANOLENS.Viewer=function(t){var e;(THREE.EventDispatcher.call(this),THREE)?((t=t||{}).controlBar=void 0===t.controlBar||t.controlBar,t.controlButtons=t.controlButtons||["fullscreen","setting","video"],t.autoHideControlBar=void 0!==t.autoHideControlBar&&t.autoHideControlBar,t.autoHideInfospot=void 0===t.autoHideInfospot||t.autoHideInfospot,t.horizontalView=void 0!==t.horizontalView&&t.horizontalView,t.clickTolerance=t.clickTolerance||10,t.cameraFov=t.cameraFov||60,t.reverseDragging=t.reverseDragging||!1,t.enableReticle=t.enableReticle||!1,t.dwellTime=t.dwellTime||1500,t.autoReticleSelect=void 0===t.autoReticleSelect||t.autoReticleSelect,t.viewIndicator=void 0!==t.viewIndicator&&t.viewIndicator,t.indicatorSize=t.indicatorSize||30,t.output=t.output?t.output:"none",this.options=t,t.container?((e=t.container)._width=e.clientWidth,e._height=e.clientHeight):((e=document.createElement("div")).classList.add("panolens-container"),e.style.width="100%",e.style.height="100%",e._width=window.innerWidth,e._height=window.innerHeight,document.body.appendChild(e)),this.container=e,this.camera=t.camera||new THREE.PerspectiveCamera(this.options.cameraFov,this.container.clientWidth/this.container.clientHeight,1,1e4),this.scene=t.scene||new THREE.Scene,this.renderer=t.renderer||new THREE.WebGLRenderer({alpha:!0,antialias:!1}),this.viewIndicatorSize=t.indicatorSize,this.reticle={},this.tempEnableReticle=this.options.enableReticle,this.mode=PANOLENS.Modes.NORMAL,this.OrbitControls,this.DeviceOrientationControls,this.CardboardEffect,this.StereoEffect,this.controls,this.effect,this.panorama,this.widget,this.hoverObject,this.infospot,this.pressEntityObject,this.pressObject,this.raycaster=new THREE.Raycaster,this.raycasterPoint=new THREE.Vector2,this.userMouse=new THREE.Vector2,this.updateCallbacks=[],this.requestAnimationId,this.cameraFrustum=new THREE.Frustum,this.cameraViewProjectionMatrix=new THREE.Matrix4,this.outputDivElement,this.HANDLER_MOUSE_DOWN=this.onMouseDown.bind(this),this.HANDLER_MOUSE_UP=this.onMouseUp.bind(this),this.HANDLER_MOUSE_MOVE=this.onMouseMove.bind(this),this.HANDLER_WINDOW_RESIZE=this.onWindowResize.bind(this),this.HANDLER_KEY_DOWN=this.onKeyDown.bind(this),this.HANDLER_KEY_UP=this.onKeyUp.bind(this),this.HANDLER_TAP=this.onTap.bind(this,{clientX:this.container.clientWidth/2,clientY:this.container.clientHeight/2}),this.OUTPUT_INFOSPOT=!1,this.tweenLeftAnimation=new TWEEN.Tween,this.tweenUpAnimation=new TWEEN.Tween,this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight),this.renderer.setClearColor(0,1),this.renderer.sortObjects=!1,this.renderer.domElement.classList.add("panolens-canvas"),this.renderer.domElement.style.display="block",this.container.style.backgroundColor="#000",this.container.appendChild(this.renderer.domElement),this.OrbitControls=new THREE.OrbitControls(this.camera,this.container),this.OrbitControls.name="orbit",this.OrbitControls.minDistance=1,this.OrbitControls.noPan=!0,this.DeviceOrientationControls=new THREE.DeviceOrientationControls(this.camera),this.DeviceOrientationControls.name="device-orientation",this.DeviceOrientationControls.enabled=!1,this.camera.position.z=1,this.options.passiveRendering&&console.warn("passiveRendering is now deprecated"),this.controls=[this.OrbitControls,this.DeviceOrientationControls],this.control=this.OrbitControls,this.CardboardEffect=new THREE.CardboardEffect(this.renderer),this.CardboardEffect.setSize(this.container.clientWidth,this.container.clientHeight),this.StereoEffect=new THREE.StereoEffect(this.renderer),this.StereoEffect.setSize(this.container.clientWidth,this.container.clientHeight),this.effect=this.CardboardEffect,this.addReticle(),this.options.horizontalView&&(this.OrbitControls.minPolarAngle=Math.PI/2,this.OrbitControls.maxPolarAngle=Math.PI/2),!1!==this.options.controlBar&&this.addDefaultControlBar(this.options.controlButtons),this.options.viewIndicator&&this.addViewIndicator(),this.options.reverseDragging&&this.reverseDraggingDirection(),this.options.enableReticle?this.enableReticleControl():this.registerMouseAndTouchEvents(),"overlay"===this.options.output&&this.addOutputElement(),this.registerEventListeners(),this.animate.call(this)):console.error("Three.JS not found")},PANOLENS.Viewer.prototype=Object.create(THREE.EventDispatcher.prototype),PANOLENS.Viewer.prototype.constructor=PANOLENS.Viewer,PANOLENS.Viewer.prototype.add=function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}this.scene.add(t),t.addEventListener&&t.addEventListener("panolens-viewer-handler",this.eventHandler.bind(this)),t instanceof PANOLENS.Panorama&&t.dispatchEvent&&t.dispatchEvent({type:"panolens-container",container:this.container}),"panorama"===t.type&&(this.addPanoramaEventListener(t),this.panorama||this.setPanorama(t))},PANOLENS.Viewer.prototype.remove=function(t){t.removeEventListener&&t.removeEventListener("panolens-viewer-handler",this.eventHandler.bind(this)),this.scene.remove(t)},PANOLENS.Viewer.prototype.addDefaultControlBar=function(t){var e=this;this.widget?console.warn("Default control bar exists"):(this.widget=new PANOLENS.Widget(this.container),this.widget.addEventListener("panolens-viewer-handler",this.eventHandler.bind(this)),this.widget.addControlBar(),t.forEach(function(t){e.widget.addControlButton(t)}))},PANOLENS.Viewer.prototype.setPanorama=function(t){var e=this.panorama;if("panorama"===t.type&&e!==t){this.hideInfospot();var i=function(){e&&e.onLeave(),t.removeEventListener("enter-fade-start",i)};t.addEventListener("enter-fade-start",i),(this.panorama=t).onEnter()}},PANOLENS.Viewer.prototype.eventHandler=function(t){t.method&&this[t.method]&&this[t.method](t.data)},PANOLENS.Viewer.prototype.dispatchEventToChildren=function(t){this.scene.traverse(function(e){e.dispatchEvent&&e.dispatchEvent(t)})},PANOLENS.Viewer.prototype.activateWidgetItem=function(t,e){var i,n=this.widget.mainMenu,o=n.children[0],r=n.children[1];if(void 0!==t){switch(t){case 0:i=o.subMenu.children[1];break;case 1:i=o.subMenu.children[2];break;default:i=o.subMenu.children[1]}o.subMenu.setActiveItem(i),o.setSelectionTitle(i.textContent)}if(void 0!==e){switch(e){case PANOLENS.Modes.CARDBOARD:i=r.subMenu.children[2];break;case PANOLENS.Modes.STEREO:i=r.subMenu.children[3];break;default:i=r.subMenu.children[1]}r.subMenu.setActiveItem(i),r.setSelectionTitle(i.textContent)}},PANOLENS.Viewer.prototype.enableEffect=function(t){if(this.mode!==t)if(t!==PANOLENS.Modes.NORMAL){this.mode=t;var e=this.camera.fov;switch(t){case PANOLENS.Modes.CARDBOARD:this.effect=this.CardboardEffect,this.enableReticleControl();break;case PANOLENS.Modes.STEREO:this.effect=this.StereoEffect,this.enableReticleControl();break;default:this.effect=null,this.disableReticleControl()}this.activateWidgetItem(void 0,this.mode),this.dispatchEventToChildren({type:"panolens-dual-eye-effect",mode:this.mode}),this.camera.fov=e+.01,this.effect.setSize(this.container.clientWidth,this.container.clientHeight),this.render(),this.camera.fov=e}else this.disableEffect()},PANOLENS.Viewer.prototype.disableEffect=function(){this.mode!==PANOLENS.Modes.NORMAL&&(this.mode=PANOLENS.Modes.NORMAL,this.disableReticleControl(),this.activateWidgetItem(void 0,this.mode),this.dispatchEventToChildren({type:"panolens-dual-eye-effect",mode:this.mode}),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight),this.render())},PANOLENS.Viewer.prototype.enableReticleControl=function(){this.reticle.visible||(this.reticle.textureLoaded||this.reticle.loadTextures(),this.tempEnableReticle=!0,this.unregisterMouseAndTouchEvents(),this.reticle.show(),this.registerReticleEvent(),this.updateReticleEvent())},PANOLENS.Viewer.prototype.disableReticleControl=function(){this.tempEnableReticle=!1,this.options.enableReticle?this.updateReticleEvent():(this.reticle.hide(),this.unregisterReticleEvent(),this.registerMouseAndTouchEvents())},PANOLENS.Viewer.prototype.toggleVideoPlay=function(t){this.panorama instanceof PANOLENS.VideoPanorama&&this.panorama.dispatchEvent({type:"video-toggle",pause:t})},PANOLENS.Viewer.prototype.setVideoCurrentTime=function(t){this.panorama instanceof PANOLENS.VideoPanorama&&this.panorama.dispatchEvent({type:"video-time",percentage:t})},PANOLENS.Viewer.prototype.onVideoUpdate=function(t){this.widget&&this.widget.dispatchEvent({type:"video-update",percentage:t})},PANOLENS.Viewer.prototype.addUpdateCallback=function(t){t&&this.updateCallbacks.push(t)},PANOLENS.Viewer.prototype.removeUpdateCallback=function(t){var e=this.updateCallbacks.indexOf(t);t&&e>=0&&this.updateCallbacks.splice(e,1)},PANOLENS.Viewer.prototype.showVideoWidget=function(){this.widget&&this.widget.dispatchEvent({type:"video-control-show"})},PANOLENS.Viewer.prototype.hideVideoWidget=function(){this.widget&&this.widget.dispatchEvent({type:"video-control-hide"})},PANOLENS.Viewer.prototype.updateVideoPlayButton=function(t){this.widget&&this.widget.videoElement&&this.widget.videoElement.controlButton&&this.widget.videoElement.controlButton.update(t)},PANOLENS.Viewer.prototype.addPanoramaEventListener=function(t){t.addEventListener("enter-fade-start",this.setCameraControl.bind(this)),t instanceof PANOLENS.VideoPanorama&&(t.addEventListener("enter-fade-start",this.showVideoWidget.bind(this)),t.addEventListener("leave",function(){this.panorama instanceof PANOLENS.VideoPanorama||this.hideVideoWidget.call(this)}.bind(this)))},PANOLENS.Viewer.prototype.setCameraControl=function(){this.OrbitControls.target.copy(this.panorama.position)},PANOLENS.Viewer.prototype.getControl=function(){return this.control},PANOLENS.Viewer.prototype.getScene=function(){return this.scene},PANOLENS.Viewer.prototype.getCamera=function(){return this.camera},PANOLENS.Viewer.prototype.getRenderer=function(){return this.renderer},PANOLENS.Viewer.prototype.getContainer=function(){return this.container},PANOLENS.Viewer.prototype.getControlName=function(){return this.control.name},PANOLENS.Viewer.prototype.getNextControlName=function(){return this.controls[this.getNextControlIndex()].name},PANOLENS.Viewer.prototype.getNextControlIndex=function(){var t,e,i;return t=this.controls,e=this.control,(i=t.indexOf(e)+1)>=t.length?0:i},PANOLENS.Viewer.prototype.setCameraFov=function(t){this.camera.fov=t,this.camera.updateProjectionMatrix()},PANOLENS.Viewer.prototype.enableControl=function(t){switch(t=t>=0&&t<this.controls.length?t:0,this.control.enabled=!1,this.control=this.controls[t],this.control.enabled=!0,t){case PANOLENS.Controls.ORBIT:this.camera.position.copy(this.panorama.position),this.camera.position.z+=1;break;case PANOLENS.Controls.DEVICEORIENTATION:this.camera.position.copy(this.panorama.position)}this.control.update(),this.activateWidgetItem(t,void 0)},PANOLENS.Viewer.prototype.disableControl=function(){this.control.enabled=!1},PANOLENS.Viewer.prototype.toggleNextControl=function(){this.enableControl(this.getNextControlIndex())},PANOLENS.Viewer.prototype.getScreenVector=function(t){var e=t.clone(),i=this.container.clientWidth/2,n=this.container.clientHeight/2;return e.project(this.camera),e.x=e.x*i+i,e.y=-e.y*n+n,e.z=0,e},PANOLENS.Viewer.prototype.checkSpriteInViewport=function(t){return this.camera.matrixWorldInverse.getInverse(this.camera.matrixWorld),this.cameraViewProjectionMatrix.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse),this.cameraFrustum.setFromMatrix(this.cameraViewProjectionMatrix),t.visible&&this.cameraFrustum.intersectsSprite(t)},PANOLENS.Viewer.prototype.reverseDraggingDirection=function(){this.OrbitControls.rotateSpeed*=-1,this.OrbitControls.momentumScalingFactor*=-1},PANOLENS.Viewer.prototype.addReticle=function(){this.reticle=new PANOLENS.Reticle(16777215,this.options.autoReticleSelect,PANOLENS.DataImage.ReticleIdle,PANOLENS.DataImage.ReticleDwell,this.options.dwellTime,45),this.reticle.position.z=-10,this.camera.add(this.reticle),this.scene.add(this.camera)},PANOLENS.Viewer.prototype.tweenControlCenter=function(t,e,i){var n,o,r,a,s,h,c,l,u,d;this.control===this.OrbitControls&&(t instanceof Array&&(e=t[1],i=t[2],t=t[0]),e=void 0!==e?e:1e3,i=i||TWEEN.Easing.Exponential.Out,n=this,s=(a=this.camera.getWorldDirection()).clone(),l=this.panorama.getWorldPosition().sub(this.camera.getWorldPosition()),(h=t.clone()).x*=-1,h.add(l).normalize(),c=h.clone(),a.y=0,h.y=0,o=(o=(o=Math.atan2(h.z,h.x)-Math.atan2(a.z,a.x))>Math.PI?o-2*Math.PI:o)<-Math.PI?o+2*Math.PI:o,r=Math.abs(s.angleTo(a)+(s.y*c.y<=0?c.angleTo(h):-c.angleTo(h))),r*=c.y<s.y?1:-1,u={left:0,up:0},d={left:0,up:0},this.tweenLeftAnimation.stop(),this.tweenUpAnimation.stop(),this.tweenLeftAnimation=new TWEEN.Tween(u).to({left:o},e).easing(i).onUpdate(function(){n.control.rotateLeft(this.left-d.left),d.left=this.left}).start(),this.tweenUpAnimation=new TWEEN.Tween(u).to({up:r},e).easing(i).onUpdate(function(){n.control.rotateUp(this.up-d.up),d.up=this.up}).start())},PANOLENS.Viewer.prototype.tweenControlCenterByObject=function(t,e,i){var n=!1;if(t.traverseAncestors(function(t){t.scalePlaceHolder&&(n=!0)}),n){var o=new THREE.Vector3(-1,1,1);this.tweenControlCenter(t.getWorldPosition().multiply(o),e,i)}else this.tweenControlCenter(t.getWorldPosition(),e,i)},PANOLENS.Viewer.prototype.onWindowResize=function(t,e){var i,n,o;o=this.container.classList.contains("panolens-container")||this.container.isFullscreen,void 0!==t&&void 0!==e?(i=t,n=e,this.container._width=t,this.container._height=e):(i=o?Math.max(document.documentElement.clientWidth,window.innerWidth||0):this.container.clientWidth,n=o?Math.max(document.documentElement.clientHeight,window.innerHeight||0):this.container.clientHeight,this.container._width=i,this.container._height=n),this.camera.aspect=i/n,this.camera.updateProjectionMatrix(),this.renderer.setSize(i,n),(this.options.enableReticle||this.tempEnableReticle)&&this.updateReticleEvent(),this.dispatchEvent({type:"window-resize",width:i,height:n}),this.scene.traverse(function(t){t.dispatchEvent&&t.dispatchEvent({type:"window-resize",width:i,height:n})})},PANOLENS.Viewer.prototype.addOutputElement=function(){var t=document.createElement("div");t.style.position="absolute",t.style.right="10px",t.style.top="10px",t.style.color="#fff",this.container.appendChild(t),this.outputDivElement=t},PANOLENS.Viewer.prototype.outputInfospotPosition=function(){var t,e,i,n;if((t=this.raycaster.intersectObject(this.panorama,!0)).length>0)switch(e=t[0].point,i=this.panorama.getWorldPosition(),n=new THREE.Vector3(-(e.x-i.x).toFixed(2),(e.y-i.y).toFixed(2),(e.z-i.z).toFixed(2)),this.options.output){case"console":console.info(n.x+", "+n.y+", "+n.z);break;case"overlay":this.outputDivElement.textContent=n.x+", "+n.y+", "+n.z}},PANOLENS.Viewer.prototype.onMouseDown=function(t){t.preventDefault(),this.userMouse.x=t.clientX>=0?t.clientX:t.touches[0].clientX,this.userMouse.y=t.clientY>=0?t.clientY:t.touches[0].clientY,this.userMouse.type="mousedown",this.onTap(t)},PANOLENS.Viewer.prototype.onMouseMove=function(t){t.preventDefault(),this.userMouse.type="mousemove",this.onTap(t)},PANOLENS.Viewer.prototype.onMouseUp=function(t){var e,i=!1;this.userMouse.type="mouseup",e=this.userMouse.x>=t.clientX-this.options.clickTolerance&&this.userMouse.x<=t.clientX+this.options.clickTolerance&&this.userMouse.y>=t.clientY-this.options.clickTolerance&&this.userMouse.y<=t.clientY+this.options.clickTolerance||t.changedTouches&&this.userMouse.x>=t.changedTouches[0].clientX-this.options.clickTolerance&&this.userMouse.x<=t.changedTouches[0].clientX+this.options.clickTolerance&&this.userMouse.y>=t.changedTouches[0].clientY-this.options.clickTolerance&&this.userMouse.y<=t.changedTouches[0].clientY+this.options.clickTolerance?"click":void 0,t&&t.target&&!t.target.classList.contains("panolens-canvas")||(t.preventDefault(),i=t.changedTouches&&1===t.changedTouches.length?this.onTap({clientX:t.changedTouches[0].clientX,clientY:t.changedTouches[0].clientY},e):this.onTap(t,e),this.userMouse.type="none",i||"click"===e&&(this.options.autoHideInfospot&&this.panorama&&this.panorama.toggleInfospotVisibility(),this.options.autoHideControlBar&&this.toggleControlBar()))},PANOLENS.Viewer.prototype.onTap=function(t,e){var i,n,o;if(this.raycasterPoint.x=(t.clientX-this.container.offsetLeft)/this.container.clientWidth*2-1,this.raycasterPoint.y=-(t.clientY-this.container.offsetTop)/this.container.clientHeight*2+1,this.raycaster.setFromCamera(this.raycasterPoint,this.camera),this.panorama)if(("mousedown"!==t.type&&PANOLENS.Utils.checkTouchSupported()||this.OUTPUT_INFOSPOT)&&this.outputInfospotPosition(),i=this.raycaster.intersectObjects(this.panorama.children,!0),n=this.getConvertedIntersect(i),o=i.length>0?i[0].object:o,"mouseup"===this.userMouse.type&&(n&&this.pressEntityObject===n&&this.pressEntityObject.dispatchEvent&&this.pressEntityObject.dispatchEvent({type:"pressstop-entity",mouseEvent:t}),this.pressEntityObject=void 0),"mouseup"===this.userMouse.type&&(o&&this.pressObject===o&&this.pressObject.dispatchEvent&&this.pressObject.dispatchEvent({type:"pressstop",mouseEvent:t}),this.pressObject=void 0),"click"===e?(this.panorama.dispatchEvent({type:"click",intersects:i,mouseEvent:t}),n&&n.dispatchEvent&&n.dispatchEvent({type:"click-entity",mouseEvent:t}),o&&o.dispatchEvent&&o.dispatchEvent({type:"click",mouseEvent:t})):(this.panorama.dispatchEvent({type:"hover",intersects:i,mouseEvent:t}),(this.hoverObject&&i.length>0&&this.hoverObject!==n||this.hoverObject&&0===i.length)&&(this.hoverObject.dispatchEvent&&(this.hoverObject.dispatchEvent({type:"hoverleave",mouseEvent:t}),this.reticle.cancelDwelling()),this.hoverObject=void 0),n&&i.length>0&&(this.hoverObject!==n&&(this.hoverObject=n,this.hoverObject.dispatchEvent&&(this.hoverObject.dispatchEvent({type:"hoverenter",mouseEvent:t}),(this.options.autoReticleSelect&&this.options.enableReticle||this.tempEnableReticle)&&this.reticle.startDwelling(this.onTap.bind(this,t,"click")))),"mousedown"===this.userMouse.type&&this.pressEntityObject!=n&&(this.pressEntityObject=n,this.pressEntityObject.dispatchEvent&&this.pressEntityObject.dispatchEvent({type:"pressstart-entity",mouseEvent:t})),"mousedown"===this.userMouse.type&&this.pressObject!=o&&(this.pressObject=o,this.pressObject.dispatchEvent&&this.pressObject.dispatchEvent({type:"pressstart",mouseEvent:t})),("mousemove"===this.userMouse.type||this.options.enableReticle)&&(o&&o.dispatchEvent&&o.dispatchEvent({type:"hover",mouseEvent:t}),this.pressEntityObject&&this.pressEntityObject.dispatchEvent&&this.pressEntityObject.dispatchEvent({type:"pressmove-entity",mouseEvent:t}),this.pressObject&&this.pressObject.dispatchEvent&&this.pressObject.dispatchEvent({type:"pressmove",mouseEvent:t}))),!n&&this.pressEntityObject&&this.pressEntityObject.dispatchEvent&&(this.pressEntityObject.dispatchEvent({type:"pressstop-entity",mouseEvent:t}),this.pressEntityObject=void 0),!o&&this.pressObject&&this.pressObject.dispatchEvent&&(this.pressObject.dispatchEvent({type:"pressstop",mouseEvent:t}),this.pressObject=void 0)),o&&o instanceof PANOLENS.Infospot){if(this.infospot=o,"click"===e)return!0}else this.infospot&&this.hideInfospot()},PANOLENS.Viewer.prototype.getConvertedIntersect=function(t){for(var e,i=0;i<t.length;i++)if(t[i].distance>=0&&t[i].object&&!t[i].object.passThrough){if(t[i].object.entity&&t[i].object.entity.passThrough)continue;if(t[i].object.entity&&!t[i].object.entity.passThrough){e=t[i].object.entity;break}e=t[i].object;break}return e},PANOLENS.Viewer.prototype.hideInfospot=function(t){this.infospot&&(this.infospot.onHoverEnd(),this.infospot=void 0)},PANOLENS.Viewer.prototype.toggleControlBar=function(){this.widget&&this.widget.dispatchEvent({type:"control-bar-toggle"})},PANOLENS.Viewer.prototype.onKeyDown=function(t){this.options.output&&"none"!==this.options.output&&"Control"===t.key&&(this.OUTPUT_INFOSPOT=!0)},PANOLENS.Viewer.prototype.onKeyUp=function(t){this.OUTPUT_INFOSPOT=!1},PANOLENS.Viewer.prototype.update=function(){TWEEN.update(),this.updateCallbacks.forEach(function(t){t()}),this.control.update(),this.scene.traverse(function(t){if(t instanceof PANOLENS.Infospot&&t.element&&(this.hoverObject===t||"none"!==t.element.style.display||t.element.left&&"none"!==t.element.left.style.display||t.element.right&&"none"!==t.element.right.style.display))if(this.checkSpriteInViewport(t)){var e=this.getScreenVector(t.getWorldPosition());t.translateElement(e.x,e.y)}else t.onDismiss()}.bind(this))},PANOLENS.Viewer.prototype.render=function(){this.mode===PANOLENS.Modes.CARDBOARD||this.mode===PANOLENS.Modes.STEREO?this.effect.render(this.scene,this.camera):this.renderer.render(this.scene,this.camera)},PANOLENS.Viewer.prototype.animate=function(){this.requestAnimationId=window.requestAnimationFrame(this.animate.bind(this)),this.onChange()},PANOLENS.Viewer.prototype.onChange=function(){this.update(),this.render()},PANOLENS.Viewer.prototype.registerMouseAndTouchEvents=function(){this.container.addEventListener("mousedown",this.HANDLER_MOUSE_DOWN,!1),this.container.addEventListener("mousemove",this.HANDLER_MOUSE_MOVE,!1),this.container.addEventListener("mouseup",this.HANDLER_MOUSE_UP,!1),this.container.addEventListener("touchstart",this.HANDLER_MOUSE_DOWN,!1),this.container.addEventListener("touchend",this.HANDLER_MOUSE_UP,!1)},PANOLENS.Viewer.prototype.unregisterMouseAndTouchEvents=function(){this.container.removeEventListener("mousedown",this.HANDLER_MOUSE_DOWN,!1),this.container.removeEventListener("mousemove",this.HANDLER_MOUSE_MOVE,!1),this.container.removeEventListener("mouseup",this.HANDLER_MOUSE_UP,!1),this.container.removeEventListener("touchstart",this.HANDLER_MOUSE_DOWN,!1),this.container.removeEventListener("touchend",this.HANDLER_MOUSE_UP,!1)},PANOLENS.Viewer.prototype.registerReticleEvent=function(){this.addUpdateCallback(this.HANDLER_TAP)},PANOLENS.Viewer.prototype.unregisterReticleEvent=function(){this.removeUpdateCallback(this.HANDLER_TAP)},PANOLENS.Viewer.prototype.updateReticleEvent=function(){var t,e;t=this.container.clientWidth/2+this.container.offsetLeft,e=this.container.clientHeight/2,this.removeUpdateCallback(this.HANDLER_TAP),this.HANDLER_TAP=this.onTap.bind(this,{clientX:t,clientY:e}),this.addUpdateCallback(this.HANDLER_TAP)},PANOLENS.Viewer.prototype.registerEventListeners=function(){window.addEventListener("resize",this.HANDLER_WINDOW_RESIZE,!0),window.addEventListener("keydown",this.HANDLER_KEY_DOWN,!0),window.addEventListener("keyup",this.HANDLER_KEY_UP,!0)},PANOLENS.Viewer.prototype.unregisterEventListeners=function(){window.removeEventListener("resize",this.HANDLER_WINDOW_RESIZE,!0),window.removeEventListener("keydown",this.HANDLER_KEY_DOWN,!0),window.removeEventListener("keyup",this.HANDLER_KEY_UP,!0)},PANOLENS.Viewer.prototype.dispose=function(){this.unregisterEventListeners(),function t(e){for(var i=e.children.length-1;i>=0;i--)t(e.children[i]),e.remove(e.children[i]);e instanceof PANOLENS.Infospot&&e.dispose(),e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()}(this.scene),this.widget&&(this.widget.dispose(),this.widget=null),THREE.Cache&&THREE.Cache.enabled&&THREE.Cache.clear()},PANOLENS.Viewer.prototype.destory=function(){this.dispose(),this.render(),window.cancelAnimationFrame(this.requestAnimationId)},PANOLENS.Viewer.prototype.onPanoramaDispose=function(t){t instanceof PANOLENS.VideoPanorama&&this.hideVideoWidget(),t===this.panorama&&(this.panorama=null)},PANOLENS.Viewer.prototype.loadAsyncRequest=function(t,e){var i=new XMLHttpRequest;i.onloadend=function(t){e&&e(t)},i.open("GET",t,!0),i.send(null)},PANOLENS.Viewer.prototype.addViewIndicator=function(){var t=this;this.loadAsyncRequest(PANOLENS.DataImage.ViewIndicator,function(e){if(0!==e.loaded){var i=e.target.responseXML.documentElement;i.style.width=t.viewIndicatorSize+"px",i.style.height=t.viewIndicatorSize+"px",i.style.position="absolute",i.style.top="10px",i.style.left="10px",i.style.opacity="0.5",i.style.cursor="pointer",i.id="panolens-view-indicator-container",t.container.appendChild(i);var n=i.querySelector("#indicator");t.addUpdateCallback(function(){t.radius=.225*t.viewIndicatorSize,t.currentPanoAngle=t.camera.rotation.y-THREE.Math.degToRad(90),t.fovAngle=THREE.Math.degToRad(t.camera.fov),t.leftAngle=-t.currentPanoAngle-t.fovAngle/2,t.rightAngle=-t.currentPanoAngle+t.fovAngle/2,t.leftX=t.radius*Math.cos(t.leftAngle),t.leftY=t.radius*Math.sin(t.leftAngle),t.rightX=t.radius*Math.cos(t.rightAngle),t.rightY=t.radius*Math.sin(t.rightAngle),t.indicatorD="M "+t.leftX+" "+t.leftY+" A "+t.radius+" "+t.radius+" 0 0 1 "+t.rightX+" "+t.rightY,t.leftX&&t.leftY&&t.rightX&&t.rightY&&t.radius&&n.setAttribute("d",t.indicatorD)}),i.addEventListener("mouseenter",function(){this.style.opacity="1"}),i.addEventListener("mouseleave",function(){this.style.opacity="0.5"})}})},PANOLENS.Viewer.prototype.appendControlItem=function(t){var e=this.widget.createCustomItem(t);return"video"===t.group?this.widget.videoElement.appendChild(e):this.widget.barElement.appendChild(e),e}}(),function t(e,i,n){function o(a,s){if(!i[a]){if(!e[a]){var h="function"==typeof require&&require;if(!s&&h)return h(a,!0);if(r)return r(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=i[a]={exports:{}};e[a][0].call(l.exports,function(t){var i=e[a][1][t];return o(i||t)},l,l.exports,t,e,i,n)}return i[a].exports}for(var r="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(t,e,i){var n=t("layout-bmfont-text"),o=t("inherits"),r=t("quad-indices"),a=t("three-buffer-vertex-data"),s=t("object-assign"),h=t("./lib/vertices"),c=t("./lib/utils"),l=THREE.BufferGeometry;function u(t){l.call(this),"string"==typeof t&&(t={text:t}),this._opt=s({},t),t&&this.update(t)}e.exports=function(t){return new u(t)},o(u,l),u.prototype.update=function(t){if("string"==typeof t&&(t={text:t}),!(t=s({},this._opt,t)).font)throw new TypeError("must specify a { font } in options");this.layout=n(t);var e=!1!==t.flipY,i=t.font,o=i.common.scaleW,c=i.common.scaleH,l=this.layout.glyphs.filter(function(t){var e=t.data;return e.width*e.height>0});this.visibleGlyphs=l;var u=h.positions(l),d=h.uvs(l,o,c,e),p=r({clockwise:!0,type:"uint16",count:l.length});if(a.index(this,p,1,"uint16"),a.attr(this,"position",u,2),a.attr(this,"uv",d,2),!t.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(t.multipage){var f=h.pages(l);a.attr(this,"page",f,1)}},u.prototype.computeBoundingSphere=function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var t=this.attributes.position.array,e=this.attributes.position.itemSize;if(!t||!e||t.length<2)return this.boundingSphere.radius=0,void this.boundingSphere.center.set(0,0,0);c.computeSphere(t,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')},u.prototype.computeBoundingBox=function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var t=this.boundingBox,e=this.attributes.position.array,i=this.attributes.position.itemSize;!e||!i||e.length<2?t.makeEmpty():c.computeBox(e,t)}},{"./lib/utils":2,"./lib/vertices":3,inherits:4,"layout-bmfont-text":5,"object-assign":26,"quad-indices":27,"three-buffer-vertex-data":31}],2:[function(t,e,i){var n=2,o={min:[0,0],max:[0,0]};function r(t){var e=t.length/n;o.min[0]=t[0],o.min[1]=t[1],o.max[0]=t[0],o.max[1]=t[1];for(var i=0;i<e;i++){var r=t[i*n+0],a=t[i*n+1];o.min[0]=Math.min(r,o.min[0]),o.min[1]=Math.min(a,o.min[1]),o.max[0]=Math.max(r,o.max[0]),o.max[1]=Math.max(a,o.max[1])}}e.exports.computeBox=function(t,e){r(t),e.min.set(o.min[0],o.min[1],0),e.max.set(o.max[0],o.max[1],0)},e.exports.computeSphere=function(t,e){r(t);var i=o.min[0],n=o.min[1],a=o.max[0]-i,s=o.max[1]-n,h=Math.sqrt(a*a+s*s);e.center.set(i+a/2,n+s/2,0),e.radius=h/2}},{}],3:[function(t,e,i){e.exports.pages=function(t){var e=new Float32Array(4*t.length*1),i=0;return t.forEach(function(t){var n=t.data.page||0;e[i++]=n,e[i++]=n,e[i++]=n,e[i++]=n}),e},e.exports.uvs=function(t,e,i,n){var o=new Float32Array(4*t.length*2),r=0;return t.forEach(function(t){var a=t.data,s=a.x+a.width,h=a.y+a.height,c=a.x/e,l=a.y/i,u=s/e,d=h/i;n&&(l=(i-a.y)/i,d=(i-h)/i),o[r++]=c,o[r++]=l,o[r++]=c,o[r++]=d,o[r++]=u,o[r++]=d,o[r++]=u,o[r++]=l}),o},e.exports.positions=function(t){var e=new Float32Array(4*t.length*2),i=0;return t.forEach(function(t){var n=t.data,o=t.position[0]+n.xoffset,r=t.position[1]+n.yoffset,a=n.width,s=n.height;e[i++]=o,e[i++]=r,e[i++]=o,e[i++]=r+s,e[i++]=o+a,e[i++]=r+s,e[i++]=o+a,e[i++]=r}),e}},{}],4:[function(t,e,i){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},{}],5:[function(t,e,i){var n=t("word-wrapper"),o=t("xtend"),r=t("indexof-property")("id"),a=t("as-number"),s=["x","e","a","o","n","s","r","c","u","m","v","w","z"],h=["m","w"],c=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"],l="\t".charCodeAt(0),u=" ".charCodeAt(0),d=0,p=1,f=2;function E(t){this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update(t)}function m(t,e){if(!t.chars||0===t.chars.length)return null;var i=r(t.chars,e);return i>=0?t.chars[i]:null}function v(t,e,i){if(!t.kernings||0===t.kernings.length)return 0;for(var n=t.kernings,o=0;o<n.length;o++){var r=n[o];if(r.first===e&&r.second===i)return r.amount}return 0}e.exports=function(t){return new E(t)},E.prototype.update=function(t){if(t=o({measure:this._measure},t),this._opt=t,this._opt.tabSize=a(this._opt.tabSize,4),!t.font)throw new Error("must provide a valid bitmap font");var e=this.glyphs,i=t.text||"",h=t.font;this._setupSpaceGlyphs(h);var l=n.lines(i,t),u=t.width||0;e.length=0;var E=l.reduce(function(t,e){return Math.max(t,e.width,u)},0),m=0,g=0,y=a(t.lineHeight,h.common.lineHeight),N=h.common.base,w=y-N,b=t.letterSpacing||0,L=y*l.length-w,S=function(t){{if("center"===t)return p;if("right"===t)return f}return d}(this._opt.align);g-=L,this._width=E,this._height=L,this._descender=y-N,this._baseline=N,this._xHeight=function(t){for(var e=0;e<s.length;e++){var i=s[e].charCodeAt(0),n=r(t.chars,i);if(n>=0)return t.chars[n].height}return 0}(h),this._capHeight=function(t){for(var e=0;e<c.length;e++){var i=c[e].charCodeAt(0),n=r(t.chars,i);if(n>=0)return t.chars[n].height}return 0}(h),this._lineHeight=y,this._ascender=y-w-this._xHeight;var O=this;l.forEach(function(t,n){for(var o,r=t.start,a=t.end,s=t.width,c=r;c<a;c++){var l=i.charCodeAt(c),u=O.getGlyph(h,l);if(u){o&&(m+=v(h,o.id,u.id));var d=m;S===p?d+=(E-s)/2:S===f&&(d+=E-s),e.push({position:[d,g],data:u,index:c,line:n}),m+=u.xadvance+b,o=u}}g+=y,m=0}),this._linesTotal=l.length},E.prototype._setupSpaceGlyphs=function(t){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,t.chars&&0!==t.chars.length){var e=m(t,u)||function(t){for(var e=0;e<h.length;e++){var i=h[e].charCodeAt(0),n=r(t.chars,i);if(n>=0)return t.chars[n]}return 0}(t)||t.chars[0],i=this._opt.tabSize*e.xadvance;this._fallbackSpaceGlyph=e,this._fallbackTabGlyph=o(e,{x:0,y:0,xadvance:i,id:l,xoffset:0,yoffset:0,width:0,height:0})}},E.prototype.getGlyph=function(t,e){var i=m(t,e);return i||(e===l?this._fallbackTabGlyph:e===u?this._fallbackSpaceGlyph:null)},E.prototype.computeMetrics=function(t,e,i,n){var o,r=this._opt.letterSpacing||0,a=this._opt.font,s=0,h=0,c=0;if(!a.chars||0===a.chars.length)return{start:e,end:e,width:0};i=Math.min(t.length,i);for(var l=e;l<i;l++){var u,d=t.charCodeAt(l);if(u=this.getGlyph(a,d)){u.xoffset;var p=(s+=o?v(a,o.id,u.id):0)+u.xadvance+r,f=s+u.width;if(f>=n||p>=n)break;s=p,h=f,o=u}c++}return o&&(h+=o.xoffset),{start:e,end:e+c,width:h}},["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach(function(t){Object.defineProperty(E.prototype,t,{get:(e=t,new Function(["return function "+e+"() {","  return this._"+e,"}"].join("\n"))()),configurable:!0});var e})},{"as-number":6,"indexof-property":7,"word-wrapper":8,xtend:9}],6:[function(t,e,i){e.exports=function(t,e){return"number"==typeof t?t:"number"==typeof e?e:0}},{}],7:[function(t,e,i){e.exports=function(t){if(!t||"string"!=typeof t)throw new Error("must specify property for indexof search");return new Function("array","value","start",["start = start || 0","for (var i=start; i<array.length; i++)",'  if (array[i]["'+t+'"] === value)',"      return i","return -1"].join("\n"))}},{}],8:[function(t,e,i){var n=/\n/,o="\n",r=/\s/;function a(t,e,i,n){var o=Rv.indexOf(e,i);return-1===o||o>n?n:o}function s(t){return r.test(t)}function h(t,e,i,n){return{start:e,end:e+Math.min(n,i-e)}}e.exports=function(t,i){return e.exports.lines(t,i).map(function(e){return t.substring(e.start,e.end)}).join("\n")},e.exports.lines=function(t,e){if(0===(e=e||{}).width&&"nowrap"!==e.mode)return[];t=t||"";var i="number"==typeof e.width?e.width:Number.MAX_VALUE,r=Math.max(0,e.start||0),c="number"==typeof e.end?e.end:t.length,l=e.mode,u=e.measure||h;return"pre"===l?function(t,e,i,o,r){for(var a=[],s=i,h=i;h<o&&h<e.length;h++){var c=e.charAt(h),l=n.test(c);if(l||h===o-1){var u=l?h:h+1,d=t(e,s,u,r);a.push(d),s=h+1}}return a}(u,t,r,c,i):function(t,e,i,n,r,h){var c=[],l=r;"nowrap"===h&&(l=Number.MAX_VALUE);for(;i<n&&i<e.length;){for(var u=a(e,o,i,n);i<u&&s(e.charAt(i));)i++;var d=t(e,i,u,l),p=i+(d.end-d.start),f=p+o.length;if(p<u){for(;p>i&&!s(e.charAt(p));)p--;if(p===i)f>i+o.length&&f--,p=f;else for(f=p;p>i&&s(e.charAt(p-o.length));)p--}if(p>=i){var E=t(e,i,p,l);c.push(E)}i=f}return c}(u,t,r,c,i,l)}},{}],9:[function(t,e,i){e.exports=function(){for(var t={},e=0;e<arguments.length;e++){var i=arguments[e];for(var o in i)n.call(i,o)&&(t[o]=i[o])}return t};var n=Object.prototype.hasOwnProperty},{}],10:[function(t,e,i){(function(i){var n=t("xhr"),o=function(){},r=t("parse-bmfont-ascii"),a=t("parse-bmfont-xml"),s=t("parse-bmfont-binary"),h=t("./lib/is-binary"),c=t("xtend"),l=window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest;e.exports=function(t,e){e="function"==typeof e?e:o,"string"==typeof t?t={uri:t}:t||(t={}),t.binary&&(t=function(t){if(l)return c(t,{responseType:"arraybuffer"});if(void 0===window.XMLHttpRequest)throw new Error("your browser does not support XHR loading");var e=new window.XMLHttpRequest;return e.overrideMimeType("text/plain; charset=x-user-defined"),c({xhr:e},t)}(t)),n(t,function(n,c,l){if(n)return e(n);if(!/^2/.test(c.statusCode))return e(new Error("http status code: "+c.statusCode));if(!l)return e(new Error("no body result"));var u,d,p=!1;if(u=l,"[object ArrayBuffer]"===Object.prototype.toString.call(u)){var f=new Uint8Array(l);l=new i(f,"binary")}h(l)&&(p=!0,"string"==typeof l&&(l=new i(l,"binary"))),p||(i.isBuffer(l)&&(l=l.toString(t.encoding)),l=l.trim());try{var E=c.headers["content-type"];d=p?s(l):/json/.test(E)||"{"===l.charAt(0)?JSON.parse(l):/xml/.test(E)||"<"===l.charAt(0)?a(l):r(l)}catch(t){e(new Error("error parsing font "+t.message)),e=o}e(null,d)})}}).call(this,t("buffer").Buffer)},{"./lib/is-binary":11,buffer:37,"parse-bmfont-ascii":13,"parse-bmfont-binary":14,"parse-bmfont-xml":15,xhr:18,xtend:25}],11:[function(t,e,i){(function(i){var n=t("buffer-equal"),o=new i([66,77,70,3]);e.exports=function(t){return"string"==typeof t?"BMF"===t.substring(0,3):t.length>4&&n(t.slice(0,4),o)}}).call(this,t("buffer").Buffer)},{buffer:37,"buffer-equal":12}],12:[function(t,e,i){var n=t("buffer").Buffer;e.exports=function(t,e){if(n.isBuffer(t)&&n.isBuffer(e)){if("function"==typeof t.equals)return t.equals(e);if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}}},{buffer:37}],13:[function(t,e,i){function n(t,e){if(!(t=t.replace(/\t+/g," ").trim()))return null;var i=t.indexOf(" ");if(-1===i)throw new Error("no named row at line "+e);var n=t.substring(0,i);t=(t=(t=(t=t.substring(i+1)).replace(/letter=[\'\"]\S+[\'\"]/gi,"")).split("=")).map(function(t){return t.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)});for(var r=[],a=0;a<t.length;a++){var s=t[a];0===a?r.push({key:s[0],data:""}):a===t.length-1?r[r.length-1].data=o(s[0]):(r[r.length-1].data=o(s[0]),r.push({key:s[1],data:""}))}var h={key:n,data:{}};return r.forEach(function(t){h.data[t.key]=t.data}),h}function o(t){return t&&0!==t.length?0===t.indexOf('"')||0===t.indexOf("'")?t.substring(1,t.length-1):-1!==t.indexOf(",")?t.split(",").map(function(t){return parseInt(t,10)}):parseInt(t,10):""}e.exports=function(t){if(!t)throw new Error("no data provided");var e={pages:[],chars:[],kernings:[]},i=(t=t.toString().trim()).split(/\r\n?|\n/g);if(0===i.length)throw new Error("no data in BMFont file");for(var o=0;o<i.length;o++){var r=n(i[o],o);if(r)if("page"===r.key){if("number"!=typeof r.data.id)throw new Error("malformed file at line "+o+" -- needs page id=N");if("string"!=typeof r.data.file)throw new Error("malformed file at line "+o+' -- needs page file="path"');e.pages[r.data.id]=r.data.file}else"chars"===r.key||"kernings"===r.key||("char"===r.key?e.chars.push(r.data):"kerning"===r.key?e.kernings.push(r.data):e[r.key]=r.data)}return e}},{}],14:[function(t,e,i){var n=[66,77,70];function o(t,e,i){if(i>e.length-1)return 0;var n=e.readUInt8(i++),o=e.readInt32LE(i);switch(i+=4,n){case 1:t.info=function(t,e){var i={};i.size=t.readInt16LE(e);var n=t.readUInt8(e+2);i.smooth=n>>7&1,i.unicode=n>>6&1,i.italic=n>>5&1,i.bold=n>>4&1,n>>3&1&&(i.fixedHeight=1);return i.charset=t.readUInt8(e+3)||"",i.stretchH=t.readUInt16LE(e+4),i.aa=t.readUInt8(e+6),i.padding=[t.readInt8(e+7),t.readInt8(e+8),t.readInt8(e+9),t.readInt8(e+10)],i.spacing=[t.readInt8(e+11),t.readInt8(e+12)],i.outline=t.readUInt8(e+13),i.face=(o=t,a=e+14,r(o,a).toString("utf8")),i;var o,a}(e,i);break;case 2:t.common=function(t,e){var i={};i.lineHeight=t.readUInt16LE(e),i.base=t.readUInt16LE(e+2),i.scaleW=t.readUInt16LE(e+4),i.scaleH=t.readUInt16LE(e+6),i.pages=t.readUInt16LE(e+8);t.readUInt8(e+10);return i.packed=0,i.alphaChnl=t.readUInt8(e+11),i.redChnl=t.readUInt8(e+12),i.greenChnl=t.readUInt8(e+13),i.blueChnl=t.readUInt8(e+14),i}(e,i);break;case 3:t.pages=function(t,e,i){for(var n=[],o=r(t,e),a=o.length+1,s=i/a,h=0;h<s;h++)n[h]=t.slice(e,e+o.length).toString("utf8"),e+=a;return n}(e,i,o);break;case 4:t.chars=function(t,e,i){for(var n=[],o=i/20,r=0;r<o;r++){var a={},s=20*r;a.id=t.readUInt32LE(e+0+s),a.x=t.readUInt16LE(e+4+s),a.y=t.readUInt16LE(e+6+s),a.width=t.readUInt16LE(e+8+s),a.height=t.readUInt16LE(e+10+s),a.xoffset=t.readInt16LE(e+12+s),a.yoffset=t.readInt16LE(e+14+s),a.xadvance=t.readInt16LE(e+16+s),a.page=t.readUInt8(e+18+s),a.chnl=t.readUInt8(e+19+s),n[r]=a}return n}(e,i,o);break;case 5:t.kernings=function(t,e,i){for(var n=[],o=i/10,r=0;r<o;r++){var a={},s=10*r;a.first=t.readUInt32LE(e+0+s),a.second=t.readUInt32LE(e+4+s),a.amount=t.readInt16LE(e+8+s),n[r]=a}return n}(e,i,o)}return 5+o}function r(t,e){for(var i=e;i<t.length&&0!==t[i];i++);return t.slice(e,i)}e.exports=function(t){if(t.length<6)throw new Error("invalid buffer length for BMFont");if(!n.every(function(e,i){return t.readUInt8(i)===e}))throw new Error("BMFont missing BMF byte header");var e=3;if(t.readUInt8(e++)>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var i={kernings:[],chars:[]},r=0;r<5;r++)e+=o(i,t,e);return i}},{}],15:[function(t,e,i){var n=t("./parse-attribs"),o=t("xml-parse-from-string"),r={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"};function a(t){return function(t){for(var e=[],i=0;i<t.attributes.length;i++)e.push(t.attributes[i]);return e}(t).reduce(function(t,e){var i;return t[(i=e.nodeName,r[i.toLowerCase()]||i)]=e.nodeValue,t},{})}e.exports=function(t){t=t.toString();var e=o(t),i={pages:[],chars:[],kernings:[]};["info","common"].forEach(function(t){var o=e.getElementsByTagName(t)[0];o&&(i[t]=n(a(o)))});var r=e.getElementsByTagName("pages")[0];if(!r)throw new Error("malformed file -- no <pages> element");for(var s=r.getElementsByTagName("page"),h=0;h<s.length;h++){var c=s[h],l=parseInt(c.getAttribute("id"),10),u=c.getAttribute("file");if(isNaN(l))throw new Error('malformed file -- page "id" attribute is NaN');if(!u)throw new Error('malformed file -- needs page "file" attribute');i.pages[parseInt(l,10)]=u}return["chars","kernings"].forEach(function(t){var o=e.getElementsByTagName(t)[0];if(o)for(var r=t.substring(0,t.length-1),s=o.getElementsByTagName(r),h=0;h<s.length;h++){var c=s[h];i[t].push(n(a(c)))}}),i}},{"./parse-attribs":16,"xml-parse-from-string":17}],16:[function(t,e,i){var n="chasrset";e.exports=function(t){n in t&&(t.charset=t[n],delete t[n]);for(var e in t)"face"!==e&&"charset"!==e&&(t[e]="padding"===e||"spacing"===e?t[e].split(",").map(function(t){return parseInt(t,10)}):parseInt(t[e],10));return t}},{}],17:[function(t,e,i){e.exports=void 0!==window.DOMParser?function(t){return(new window.DOMParser).parseFromString(t,"application/xml")}:void 0!==window.ActiveXObject&&new window.ActiveXObject("Microsoft.XMLDOM")?function(t){var e=new window.ActiveXObject("Microsoft.XMLDOM");return e.async="false",e.loadXML(t),e}:function(t){var e=document.createElement("div");return e.innerHTML=t,e}},{}],18:[function(t,e,i){"use strict";var n=t("global/window"),o=t("once"),r=t("is-function"),a=t("parse-headers"),s=t("xtend");function h(t,e,i){var n=t;return r(e)?(i=e,"string"==typeof t&&(n={uri:t})):n=s(e,{uri:t}),n.callback=i,n}function c(t,e,i){return l(e=h(t,e,i))}function l(t){var e=t.callback;if(void 0===e)throw new Error("callback argument missing");e=o(e);var i={body:void 0,headers:{},statusCode:0,method:p,url:d,rawRequest:l};function n(t){clearTimeout(u),t instanceof Error||(t=new Error(""+(t||"Unknown XMLHttpRequest Error"))),t.statusCode=0,e(t,i)}function r(){if(!h){var n;clearTimeout(u),n=t.useXDR&&void 0===l.status?200:1223===l.status?204:l.status;var o=i,r=null;0!==n?(o={body:function(){var t=void 0;if(l.response?t=l.response:"text"!==l.responseType&&l.responseType||(t=l.responseText||l.responseXML),v)try{t=JSON.parse(t)}catch(t){}return t}(),statusCode:n,method:p,headers:{},url:d,rawRequest:l},l.getAllResponseHeaders&&(o.headers=a(l.getAllResponseHeaders()))):r=new Error("Internal XMLHttpRequest Error"),e(r,o,o.body)}}var s,h,l=t.xhr||null;l||(l=t.cors||t.useXDR?new c.XDomainRequest:new c.XMLHttpRequest);var u,d=l.url=t.uri||t.url,p=l.method=t.method||"GET",f=t.body||t.data||null,E=l.headers=t.headers||{},m=!!t.sync,v=!1;if("json"in t&&(v=!0,E.accept||E.Accept||(E.Accept="application/json"),"GET"!==p&&"HEAD"!==p&&(E["content-type"]||E["Content-Type"]||(E["Content-Type"]="application/json"),f=JSON.stringify(t.json))),l.onreadystatechange=function(){4===l.readyState&&r()},l.onload=r,l.onerror=n,l.onprogress=function(){},l.ontimeout=n,l.open(p,d,!m,t.username,t.password),m||(l.withCredentials=!!t.withCredentials),!m&&t.timeout>0&&(u=setTimeout(function(){h=!0,l.abort("timeout");var t=new Error("XMLHttpRequest timeout");t.code="ETIMEDOUT",n(t)},t.timeout)),l.setRequestHeader)for(s in E)E.hasOwnProperty(s)&&l.setRequestHeader(s,E[s]);else if(t.headers&&!function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}(t.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in t&&(l.responseType=t.responseType),"beforeSend"in t&&"function"==typeof t.beforeSend&&t.beforeSend(l),l.send(f),l}e.exports=c,c.XMLHttpRequest=n.XMLHttpRequest||function(){},c.XDomainRequest="withCredentials"in new c.XMLHttpRequest?c.XMLHttpRequest:n.XDomainRequest,function(t,e){for(var i=0;i<t.length;i++)e(t[i])}(["get","put","post","patch","head","delete"],function(t){c["delete"===t?"del":t]=function(e,i,n){return(i=h(e,i,n)).method=t.toUpperCase(),l(i)}})},{"global/window":19,"is-function":20,once:21,"parse-headers":24,xtend:25}],19:[function(t,e,i){(function(t){"undefined"!=typeof window?e.exports=window:void 0!==t?e.exports=t:"undefined"!=typeof self?e.exports=self:e.exports={}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],20:[function(t,e,i){e.exports=function(t){var e=n.call(t);return"[object Function]"===e||"function"==typeof t&&"[object RegExp]"!==e||"undefined"!=typeof window&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)};var n=Object.prototype.toString},{}],21:[function(t,e,i){function n(t){var e=!1;return function(){if(!e)return e=!0,t.apply(this,arguments)}}e.exports=n,n.proto=n(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return n(this)},configurable:!0})})},{}],22:[function(t,e,i){var n=t("is-function");e.exports=function(t,e,i){if(!n(e))throw new TypeError("iterator must be a function");arguments.length<3&&(i=this);"[object Array]"===o.call(t)?function(t,e,i){for(var n=0,o=t.length;n<o;n++)r.call(t,n)&&e.call(i,t[n],n,t)}(t,e,i):"string"==typeof t?function(t,e,i){for(var n=0,o=t.length;n<o;n++)e.call(i,t.charAt(n),n,t)}(t,e,i):function(t,e,i){for(var n in t)r.call(t,n)&&e.call(i,t[n],n,t)}(t,e,i)};var o=Object.prototype.toString,r=Object.prototype.hasOwnProperty},{"is-function":20}],23:[function(t,e,i){(i=e.exports=function(t){return t.replace(/^\s*|\s*$/g,"")}).left=function(t){return t.replace(/^\s*/,"")},i.right=function(t){return t.replace(/\s*$/,"")}},{}],24:[function(t,e,i){var n=t("trim"),o=t("for-each");e.exports=function(t){if(!t)return{};var e={};return o(n(t).split("\n"),function(t){var i,o=t.indexOf(":"),r=n(t.slice(0,o)).toLowerCase(),a=n(t.slice(o+1));void 0===e[r]?e[r]=a:(i=e[r],"[object Array]"===Object.prototype.toString.call(i)?e[r].push(a):e[r]=[e[r],a])}),e}},{"for-each":22,trim:23}],25:[function(t,e,i){arguments[4][9][0].apply(i,arguments)},{dup:9}],26:[function(t,e,i){"use strict";var n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=Object.assign||function(t,e){for(var i,r,a=function(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),s=1;s<arguments.length;s++){i=Object(arguments[s]);for(var h in i)n.call(i,h)&&(a[h]=i[h]);if(Object.getOwnPropertySymbols){r=Object.getOwnPropertySymbols(i);for(var c=0;c<r.length;c++)o.call(i,r[c])&&(a[r[c]]=i[r[c]])}}return a}},{}],27:[function(t,e,i){var n=t("dtype"),o=t("an-array"),r=t("is-buffer"),a=[0,2,3],s=[2,1,3];e.exports=function(t,e){t&&(o(t)||r(t))||(e=t||{},t=null);for(var i="string"==typeof(e="number"==typeof e?{count:e}:e||{}).type?e.type:"uint16",h="number"==typeof e.count?e.count:1,c=e.start||0,l=!1!==e.clockwise?a:s,u=l[0],d=l[1],p=l[2],f=6*h,E=t||new(n(i))(f),m=0,v=0;m<f;m+=6,v+=4){var g=m+c;E[g+0]=v+0,E[g+1]=v+1,E[g+2]=v+2,E[g+3]=v+u,E[g+4]=v+d,E[g+5]=v+p}return E}},{"an-array":28,dtype:29,"is-buffer":30}],28:[function(t,e,i){var n=Object.prototype.toString;e.exports=function(t){return t.BYTES_PER_ELEMENT&&"[object ArrayBuffer]"===n.call(t.buffer)||Array.isArray(t)}},{}],29:[function(t,e,i){e.exports=function(t){switch(t){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],30:[function(t,e,i){e.exports=function(t){return!(null==t||!(t._isBuffer||t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)))}},{}],31:[function(t,e,i){var n=t("flatten-vertex-data");function o(t,e,i,o){return e=e||[],!t||function(t,e,i){if(t.itemSize!==i)return!0;if(!t.array)return!0;var n=t.array.length;return Array.isArray(e)&&Array.isArray(e[0])?n!==e.length*i:n!==e.length}(t,e,i)?(e=n(e,o),(t=new THREE.BufferAttribute(e,i)).needsUpdate=!0,t):(n(e,t.array),t.needsUpdate=!0,null)}e.exports.attr=function(t,e,i,n,r){"number"!=typeof n&&(n=3);"number"!=typeof r&&(r="float32");if(Array.isArray(i)&&Array.isArray(i[0])&&i[0].length!==n)throw new Error("Nested vertex array has unexpected size; expected "+n+" but found "+i[0].length);var a=o(t.getAttribute(e),i,n,r);a&&t.addAttribute(e,a)},e.exports.index=function(t,e,i,n){"number"!=typeof i&&(i=1);"number"!=typeof n&&(n="uint16");var r=!t.index&&"function"!=typeof t.setIndex,a=o(r?t.getAttribute("index"):t.index,e,i,n);a&&(r?t.addAttribute("index",a):t.index=a)}},{"flatten-vertex-data":32}],32:[function(t,e,i){var n=t("dtype");e.exports=function(t,e,i){if(!t)throw new TypeError("must specify data as first parameter");if(i=0|+(i||0),Array.isArray(t)&&Array.isArray(t[0])){var o=t[0].length,r=t.length*o;e&&"string"!=typeof e||(e=new(n(e||"float32"))(r+i));var a=e.length-i;if(r!==a)throw new Error("source length "+r+" ("+o+"x"+t.length+") does not match destination length "+a);for(var s=0,h=i;s<t.length;s++)for(var c=0;c<o;c++)e[h++]=t[s][c]}else if(e&&"string"!=typeof e)e.set(t,i);else{var l=n(e||"float32");0===i?e=new l(t):(e=new l(t.length+i)).set(t,i)}return e}},{dtype:33}],33:[function(t,e,i){arguments[4][29][0].apply(i,arguments)},{dup:29}],34:[function(t,e,i){var n=t("object-assign");e.exports=function(t){var e="number"==typeof(t=t||{}).opacity?t.opacity:1,i="number"==typeof t.alphaTest?t.alphaTest:1e-4,o=t.precision||"highp",r=t.color,a=t.map;return delete t.map,delete t.color,delete t.precision,delete t.opacity,n({uniforms:{opacity:{type:"f",value:e},map:{type:"t",value:a||new THREE.Texture},color:{type:"c",value:new THREE.Color(r)}},vertexShader:["attribute vec2 uv;","attribute vec4 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * position;","}"].join("\n"),fragmentShader:["#ifdef GL_OES_standard_derivatives","#extension GL_OES_standard_derivatives : enable","#endif","precision "+o+" float;","uniform float opacity;","uniform vec3 color;","uniform sampler2D map;","varying vec2 vUv;","float aastep(float value) {","  #ifdef GL_OES_standard_derivatives","    float afwidth = length(vec2(dFdx(value), dFdy(value))) * 0.70710678118654757;","  #else","    float afwidth = (1.0 / 32.0) * (1.4142135623730951 / (2.0 * gl_FragCoord.w));","  #endif","  return smoothstep(0.5 - afwidth, 0.5 + afwidth, value);","}","void main() {","  vec4 texColor = texture2D(map, vUv);","  float alpha = aastep(texColor.a);","  gl_FragColor = vec4(color, opacity * alpha);",0===i?"":"  if (gl_FragColor.a < "+i+") discard;","}"].join("\n")},t)}},{"object-assign":26}],35:[function(t,e,i){var n=t("load-bmfont");e.exports=function(t,e){n(t.font,function(i,n){if(i)throw i;PANOLENS.Utils.TextureLoader.load(t.image,function(t){e(n,t)})})}},{"load-bmfont":10}],36:[function(t,e,i){var n=t("../"),o=t("../shaders/sdf");PANOLENS&&PANOLENS.Utils&&PANOLENS.SpriteText&&(PANOLENS.Utils.loadBMFont=function(e,i){t("./load")(e,PANOLENS.SpriteText.prototype.setBMFont.bind(PANOLENS.SpriteText.prototype,i))},PANOLENS.SpriteText.prototype.generateTextGeometry=n,PANOLENS.SpriteText.prototype.generateSDFShader=o)},{"../":1,"../shaders/sdf":34,"./load":35}],37:[function(t,e,i){(function(e){"use strict";var n=t("base64-js"),o=t("ieee754"),r=t("isarray");i.Buffer=h,i.SlowBuffer=function t(e,i){if(!(this instanceof t))return new t(e,i);var n=new h(e,i);delete n.parent;return n},i.INSPECT_MAX_BYTES=50,h.poolSize=8192;var a={};function s(){return h.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function h(t){return this instanceof h?(h.TYPED_ARRAY_SUPPORT||(this.length=0,this.parent=void 0),"number"==typeof t?function(t,e){if(t=l(t,e<0?0:0|u(e)),!h.TYPED_ARRAY_SUPPORT)for(var i=0;i<e;i++)t[i]=0;return t}(this,t):"string"==typeof t?function(t,e,i){"string"==typeof i&&""!==i||(i="utf8");var n=0|d(e,i);return(t=l(t,n)).write(e,i),t}(this,t,arguments.length>1?arguments[1]:"utf8"):function(t,e){if(h.isBuffer(e))return i=t,n=e,o=0|u(n.length),i=l(i,o),n.copy(i,0,0,o),i;var i,n,o;if(r(e))return function(t,e){var i=0|u(e.length);t=l(t,i);for(var n=0;n<i;n+=1)t[n]=255&e[n];return t}(t,e);if(null==e)throw new TypeError("must start with number, buffer, array or string");if("undefined"!=typeof ArrayBuffer){if(e.buffer instanceof ArrayBuffer)return c(t,e);if(e instanceof ArrayBuffer)return function(t,e){h.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=h.prototype:t=c(t,new Uint8Array(e));return t}(t,e)}return e.length?function(t,e){var i=0|u(e.length);t=l(t,i);for(var n=0;n<i;n+=1)t[n]=255&e[n];return t}(t,e):function(t,e){var i,n=0;"Buffer"===e.type&&r(e.data)&&(i=e.data,n=0|u(i.length)),t=l(t,n);for(var o=0;o<n;o+=1)t[o]=255&i[o];return t}(t,e)}(this,t)):arguments.length>1?new h(t,arguments[1]):new h(t)}function c(t,e){var i=0|u(e.length);t=l(t,i);for(var n=0;n<i;n+=1)t[n]=255&e[n];return t}function l(t,e){return h.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=h.prototype:t.length=e,0!==e&&e<=h.poolSize>>>1&&(t.parent=a),t}function u(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function d(t,e){"string"!=typeof t&&(t=""+t);var i=t.length;if(0===i)return 0;for(var n=!1;;)switch(e){case"ascii":case"binary":case"raw":case"raws":return i;case"utf8":case"utf-8":return M(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return I(t).length;default:if(n)return M(t).length;e=(""+e).toLowerCase(),n=!0}}function p(t,e,i,n){i=Number(i)||0;var o=t.length-i;n?(n=Number(n))>o&&(n=o):n=o;var r=e.length;if(r%2!=0)throw new Error("Invalid hex string");n>r/2&&(n=r/2);for(var a=0;a<n;a++){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))throw new Error("Invalid hex string");t[i+a]=s}return a}function f(t,e,i,n){return C(function(t){for(var e=[],i=0;i<t.length;i++)e.push(255&t.charCodeAt(i));return e}(e),t,i,n)}function E(t,e,i){return 0===e&&i===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,i))}function m(t,e,i){i=Math.min(t.length,i);for(var n=[],o=e;o<i;){var r,a,s,h,c=t[o],l=null,u=c>239?4:c>223?3:c>191?2:1;if(o+u<=i)switch(u){case 1:c<128&&(l=c);break;case 2:128==(192&(r=t[o+1]))&&(h=(31&c)<<6|63&r)>127&&(l=h);break;case 3:r=t[o+1],a=t[o+2],128==(192&r)&&128==(192&a)&&(h=(15&c)<<12|(63&r)<<6|63&a)>2047&&(h<55296||h>57343)&&(l=h);break;case 4:r=t[o+1],a=t[o+2],s=t[o+3],128==(192&r)&&128==(192&a)&&128==(192&s)&&(h=(15&c)<<18|(63&r)<<12|(63&a)<<6|63&s)>65535&&h<1114112&&(l=h)}null===l?(l=65533,u=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),o+=u}return function(t){var e=t.length;if(e<=v)return String.fromCharCode.apply(String,t);var i="",n=0;for(;n<e;)i+=String.fromCharCode.apply(String,t.slice(n,n+=v));return i}(n)}h.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.foo=function(){return 42},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),h.TYPED_ARRAY_SUPPORT?(h.prototype.__proto__=Uint8Array.prototype,h.__proto__=Uint8Array):(h.prototype.length=void 0,h.prototype.parent=void 0),h.isBuffer=function(t){return!(null==t||!t._isBuffer)},h.compare=function(t,e){if(!h.isBuffer(t)||!h.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var i=t.length,n=e.length,o=0,r=Math.min(i,n);o<r&&t[o]===e[o];)++o;return o!==r&&(i=t[o],n=e[o]),i<n?-1:n<i?1:0},h.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(t,e){if(!r(t))throw new TypeError("list argument must be an Array of Buffers.");if(0===t.length)return new h(0);var i;if(void 0===e)for(e=0,i=0;i<t.length;i++)e+=t[i].length;var n=new h(e),o=0;for(i=0;i<t.length;i++){var a=t[i];a.copy(n,o),o+=a.length}return n},h.byteLength=d,h.prototype._isBuffer=!0,h.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?m(this,0,t):function(t,e,i){var n=!1;if(e|=0,i=void 0===i||i===1/0?this.length:0|i,t||(t="utf8"),e<0&&(e=0),i>this.length&&(i=this.length),i<=e)return"";for(;;)switch(t){case"hex":return N(this,e,i);case"utf8":case"utf-8":return m(this,e,i);case"ascii":return g(this,e,i);case"binary":return y(this,e,i);case"base64":return E(this,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,e,i);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}.apply(this,arguments)},h.prototype.equals=function(t){if(!h.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===h.compare(this,t)},h.prototype.inspect=function(){var t="",e=i.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},h.prototype.compare=function(t){if(!h.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?0:h.compare(this,t)},h.prototype.indexOf=function(t,e){if(e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e>>=0,0===this.length)return-1;if(e>=this.length)return-1;if(e<0&&(e=Math.max(this.length+e,0)),"string"==typeof t)return 0===t.length?-1:String.prototype.indexOf.call(this,t,e);if(h.isBuffer(t))return i(this,t,e);if("number"==typeof t)return h.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,t,e):i(this,[t],e);function i(t,e,i){for(var n=-1,o=0;i+o<t.length;o++)if(t[i+o]===e[-1===n?0:o-n]){if(-1===n&&(n=o),o-n+1===e.length)return i+n}else n=-1;return-1}throw new TypeError("val must be string, number or Buffer")},h.prototype.write=function(t,e,i,n){if(void 0===e)n="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)n=e,i=this.length,e=0;else if(isFinite(e))e|=0,isFinite(i)?(i|=0,void 0===n&&(n="utf8")):(n=i,i=void 0);else{var o=n;n=e,e=0|i,i=o}var r=this.length-e;if((void 0===i||i>r)&&(i=r),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("attempt to write outside buffer bounds");n||(n="utf8");for(var a,s,h,c,l,u,d,E,m,v=!1;;)switch(n){case"hex":return p(this,t,e,i);case"utf8":case"utf-8":return E=e,m=i,C(M(t,(d=this).length-E),d,E,m);case"ascii":return f(this,t,e,i);case"binary":return f(this,t,e,i);case"base64":return c=this,l=e,u=i,C(I(t),c,l,u);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return s=e,h=i,C(function(t,e){for(var i,n,o,r=[],a=0;a<t.length&&!((e-=2)<0);a++)i=t.charCodeAt(a),n=i>>8,o=i%256,r.push(o),r.push(n);return r}(t,(a=this).length-s),a,s,h);default:if(v)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),v=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var v=4096;function g(t,e,i){var n="";i=Math.min(t.length,i);for(var o=e;o<i;o++)n+=String.fromCharCode(127&t[o]);return n}function y(t,e,i){var n="";i=Math.min(t.length,i);for(var o=e;o<i;o++)n+=String.fromCharCode(t[o]);return n}function N(t,e,i){var n=t.length;(!e||e<0)&&(e=0),(!i||i<0||i>n)&&(i=n);for(var o="",r=e;r<i;r++)o+=x(t[r]);return o}function w(t,e,i){for(var n=t.slice(e,i),o="",r=0;r<n.length;r+=2)o+=String.fromCharCode(n[r]+256*n[r+1]);return o}function b(t,e,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>i)throw new RangeError("Trying to access beyond buffer length")}function L(t,e,i,n,o,r){if(!h.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(e>o||e<r)throw new RangeError("value is out of bounds");if(i+n>t.length)throw new RangeError("index out of range")}function S(t,e,i,n){e<0&&(e=65535+e+1);for(var o=0,r=Math.min(t.length-i,2);o<r;o++)t[i+o]=(e&255<<8*(n?o:1-o))>>>8*(n?o:1-o)}function O(t,e,i,n){e<0&&(e=4294967295+e+1);for(var o=0,r=Math.min(t.length-i,4);o<r;o++)t[i+o]=e>>>8*(n?o:3-o)&255}function A(t,e,i,n,o,r){if(e>o||e<r)throw new RangeError("value is out of bounds");if(i+n>t.length)throw new RangeError("index out of range");if(i<0)throw new RangeError("index out of range")}function P(t,e,i,n,r){return r||A(t,e,i,4,3.4028234663852886e38,-3.4028234663852886e38),o.write(t,e,i,n,23,4),i+4}function T(t,e,i,n,r){return r||A(t,e,i,8,1.7976931348623157e308,-1.7976931348623157e308),o.write(t,e,i,n,52,8),i+8}h.prototype.slice=function(t,e){var i,n=this.length;if(t=~~t,e=void 0===e?n:~~e,t<0?(t+=n)<0&&(t=0):t>n&&(t=n),e<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),h.TYPED_ARRAY_SUPPORT)(i=this.subarray(t,e)).__proto__=h.prototype;else{var o=e-t;i=new h(o,void 0);for(var r=0;r<o;r++)i[r]=this[r+t]}return i.length&&(i.parent=this.parent||this),i},h.prototype.readUIntLE=function(t,e,i){t|=0,e|=0,i||b(t,e,this.length);for(var n=this[t],o=1,r=0;++r<e&&(o*=256);)n+=this[t+r]*o;return n},h.prototype.readUIntBE=function(t,e,i){t|=0,e|=0,i||b(t,e,this.length);for(var n=this[t+--e],o=1;e>0&&(o*=256);)n+=this[t+--e]*o;return n},h.prototype.readUInt8=function(t,e){return e||b(t,1,this.length),this[t]},h.prototype.readUInt16LE=function(t,e){return e||b(t,2,this.length),this[t]|this[t+1]<<8},h.prototype.readUInt16BE=function(t,e){return e||b(t,2,this.length),this[t]<<8|this[t+1]},h.prototype.readUInt32LE=function(t,e){return e||b(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},h.prototype.readUInt32BE=function(t,e){return e||b(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},h.prototype.readIntLE=function(t,e,i){t|=0,e|=0,i||b(t,e,this.length);for(var n=this[t],o=1,r=0;++r<e&&(o*=256);)n+=this[t+r]*o;return n>=(o*=128)&&(n-=Math.pow(2,8*e)),n},h.prototype.readIntBE=function(t,e,i){t|=0,e|=0,i||b(t,e,this.length);for(var n=e,o=1,r=this[t+--n];n>0&&(o*=256);)r+=this[t+--n]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*e)),r},h.prototype.readInt8=function(t,e){return e||b(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},h.prototype.readInt16LE=function(t,e){e||b(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},h.prototype.readInt16BE=function(t,e){e||b(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},h.prototype.readInt32LE=function(t,e){return e||b(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},h.prototype.readInt32BE=function(t,e){return e||b(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},h.prototype.readFloatLE=function(t,e){return e||b(t,4,this.length),o.read(this,t,!0,23,4)},h.prototype.readFloatBE=function(t,e){return e||b(t,4,this.length),o.read(this,t,!1,23,4)},h.prototype.readDoubleLE=function(t,e){return e||b(t,8,this.length),o.read(this,t,!0,52,8)},h.prototype.readDoubleBE=function(t,e){return e||b(t,8,this.length),o.read(this,t,!1,52,8)},h.prototype.writeUIntLE=function(t,e,i,n){t=+t,e|=0,i|=0,n||L(this,t,e,i,Math.pow(2,8*i),0);var o=1,r=0;for(this[e]=255&t;++r<i&&(o*=256);)this[e+r]=t/o&255;return e+i},h.prototype.writeUIntBE=function(t,e,i,n){t=+t,e|=0,i|=0,n||L(this,t,e,i,Math.pow(2,8*i),0);var o=i-1,r=1;for(this[e+o]=255&t;--o>=0&&(r*=256);)this[e+o]=t/r&255;return e+i},h.prototype.writeUInt8=function(t,e,i){return t=+t,e|=0,i||L(this,t,e,1,255,0),h.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},h.prototype.writeUInt16LE=function(t,e,i){return t=+t,e|=0,i||L(this,t,e,2,65535,0),h.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):S(this,t,e,!0),e+2},h.prototype.writeUInt16BE=function(t,e,i){return t=+t,e|=0,i||L(this,t,e,2,65535,0),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):S(this,t,e,!1),e+2},h.prototype.writeUInt32LE=function(t,e,i){return t=+t,e|=0,i||L(this,t,e,4,4294967295,0),h.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):O(this,t,e,!0),e+4},h.prototype.writeUInt32BE=function(t,e,i){return t=+t,e|=0,i||L(this,t,e,4,4294967295,0),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):O(this,t,e,!1),e+4},h.prototype.writeIntLE=function(t,e,i,n){if(t=+t,e|=0,!n){var o=Math.pow(2,8*i-1);L(this,t,e,i,o-1,-o)}var r=0,a=1,s=t<0?1:0;for(this[e]=255&t;++r<i&&(a*=256);)this[e+r]=(t/a>>0)-s&255;return e+i},h.prototype.writeIntBE=function(t,e,i,n){if(t=+t,e|=0,!n){var o=Math.pow(2,8*i-1);L(this,t,e,i,o-1,-o)}var r=i-1,a=1,s=t<0?1:0;for(this[e+r]=255&t;--r>=0&&(a*=256);)this[e+r]=(t/a>>0)-s&255;return e+i},h.prototype.writeInt8=function(t,e,i){return t=+t,e|=0,i||L(this,t,e,1,127,-128),h.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},h.prototype.writeInt16LE=function(t,e,i){return t=+t,e|=0,i||L(this,t,e,2,32767,-32768),h.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):S(this,t,e,!0),e+2},h.prototype.writeInt16BE=function(t,e,i){return t=+t,e|=0,i||L(this,t,e,2,32767,-32768),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):S(this,t,e,!1),e+2},h.prototype.writeInt32LE=function(t,e,i){return t=+t,e|=0,i||L(this,t,e,4,2147483647,-2147483648),h.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):O(this,t,e,!0),e+4},h.prototype.writeInt32BE=function(t,e,i){return t=+t,e|=0,i||L(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):O(this,t,e,!1),e+4},h.prototype.writeFloatLE=function(t,e,i){return P(this,t,e,!0,i)},h.prototype.writeFloatBE=function(t,e,i){return P(this,t,e,!1,i)},h.prototype.writeDoubleLE=function(t,e,i){return T(this,t,e,!0,i)},h.prototype.writeDoubleBE=function(t,e,i){return T(this,t,e,!1,i)},h.prototype.copy=function(t,e,i,n){if(i||(i=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-i&&(n=t.length-e+i);var o,r=n-i;if(this===t&&i<e&&e<n)for(o=r-1;o>=0;o--)t[o+e]=this[o+i];else if(r<1e3||!h.TYPED_ARRAY_SUPPORT)for(o=0;o<r;o++)t[o+e]=this[o+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+r),e);return r},h.prototype.fill=function(t,e,i){if(t||(t=0),e||(e=0),i||(i=this.length),i<e)throw new RangeError("end < start");if(i!==e&&0!==this.length){if(e<0||e>=this.length)throw new RangeError("start out of bounds");if(i<0||i>this.length)throw new RangeError("end out of bounds");var n;if("number"==typeof t)for(n=e;n<i;n++)this[n]=t;else{var o=M(t.toString()),r=o.length;for(n=e;n<i;n++)this[n]=o[n%r]}return this}};var R=/[^+\/0-9A-Za-z-_]/g;function x(t){return t<16?"0"+t.toString(16):t.toString(16)}function M(t,e){var i;e=e||1/0;for(var n=t.length,o=null,r=[],a=0;a<n;a++){if((i=t.charCodeAt(a))>55295&&i<57344){if(!o){if(i>56319){(e-=3)>-1&&r.push(239,191,189);continue}if(a+1===n){(e-=3)>-1&&r.push(239,191,189);continue}o=i;continue}if(i<56320){(e-=3)>-1&&r.push(239,191,189),o=i;continue}i=65536+(o-55296<<10|i-56320)}else o&&(e-=3)>-1&&r.push(239,191,189);if(o=null,i<128){if((e-=1)<0)break;r.push(i)}else if(i<2048){if((e-=2)<0)break;r.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;r.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;r.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return r}function I(t){return n.toByteArray(function(t){var e;if((t=(e=t,e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")).replace(R,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function C(t,e,i,n){for(var o=0;o<n&&!(o+i>=e.length||o>=t.length);o++)e[o+i]=t[o];return o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":38,ieee754:39,isarray:40}],38:[function(t,e,i){!function(t){"use strict";var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i="undefined"!=typeof Uint8Array?Uint8Array:Array,n="+".charCodeAt(0),o="/".charCodeAt(0),r="0".charCodeAt(0),a="a".charCodeAt(0),s="A".charCodeAt(0),h="-".charCodeAt(0),c="_".charCodeAt(0);function l(t){var e=t.charCodeAt(0);return e===n||e===h?62:e===o||e===c?63:e<r?-1:e<r+10?e-r+26+26:e<s+26?e-s:e<a+26?e-a+26:void 0}t.toByteArray=function(t){var e,n,o,r,a,s;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var h=t.length;a="="===t.charAt(h-2)?2:"="===t.charAt(h-1)?1:0,s=new i(3*t.length/4-a),o=a>0?t.length-4:t.length;var c=0;function u(t){s[c++]=t}for(e=0,n=0;e<o;e+=4,n+=3)u((16711680&(r=l(t.charAt(e))<<18|l(t.charAt(e+1))<<12|l(t.charAt(e+2))<<6|l(t.charAt(e+3))))>>16),u((65280&r)>>8),u(255&r);return 2===a?u(255&(r=l(t.charAt(e))<<2|l(t.charAt(e+1))>>4)):1===a&&(u((r=l(t.charAt(e))<<10|l(t.charAt(e+1))<<4|l(t.charAt(e+2))>>2)>>8&255),u(255&r)),s},t.fromByteArray=function(t){var i,n,o,r,a=t.length%3,s="";function h(t){return e.charAt(t)}for(i=0,o=t.length-a;i<o;i+=3)n=(t[i]<<16)+(t[i+1]<<8)+t[i+2],s+=h((r=n)>>18&63)+h(r>>12&63)+h(r>>6&63)+h(63&r);switch(a){case 1:s+=h((n=t[t.length-1])>>2),s+=h(n<<4&63),s+="==";break;case 2:s+=h((n=(t[t.length-2]<<8)+t[t.length-1])>>10),s+=h(n>>4&63),s+=h(n<<2&63),s+="="}return s}}(void 0===i?this.base64js={}:i)},{}],39:[function(t,e,i){i.read=function(t,e,i,n,o){var r,a,s=8*o-n-1,h=(1<<s)-1,c=h>>1,l=-7,u=i?o-1:0,d=i?-1:1,p=t[e+u];for(u+=d,r=p&(1<<-l)-1,p>>=-l,l+=s;l>0;r=256*r+t[e+u],u+=d,l-=8);for(a=r&(1<<-l)-1,r>>=-l,l+=n;l>0;a=256*a+t[e+u],u+=d,l-=8);if(0===r)r=1-c;else{if(r===h)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),r-=c}return(p?-1:1)*a*Math.pow(2,r-n)},i.write=function(t,e,i,n,o,r){var a,s,h,c=8*r-o-1,l=(1<<c)-1,u=l>>1,d=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:r-1,f=n?1:-1,E=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-a))<1&&(a--,h*=2),(e+=a+u>=1?d/h:d*Math.pow(2,1-u))*h>=2&&(a++,h/=2),a+u>=l?(s=0,a=l):a+u>=1?(s=(e*h-1)*Math.pow(2,o),a+=u):(s=e*Math.pow(2,u-1)*Math.pow(2,o),a=0));o>=8;t[i+p]=255&s,p+=f,s/=256,o-=8);for(a=a<<o|s,c+=o;c>0;t[i+p]=255&a,p+=f,a/=256,c-=8);t[i+p-f]|=128*E}},{}],40:[function(t,e,i){var n={}.toString;e.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},{}]},{},[36]);